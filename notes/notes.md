00:00:00 do you remember when building a website felt like constructing the Great Wall of China weeks of hard work endless setup and a maze of steps just to get a simple page online times have changed thanks to updates in the tech we use you can now host a full-blown Miracle Within hours to avoid spending time on configuration linting compilation bundling and deployment developers wanted no deserved a framework that would streamline things meet next year a framework that just works gets out of your way and lets you

00:00:34 do your thing in 2013 Facebook introduced react a groundbreaking technology that revolutionized web development and created countless job opportunities fast forward to today and believe it or not the official react documentation now suggests never to use plain react again instead it recommends building apps using a production grade full stack react framework nextjs first I'll lead you through a crash course to explain and visualize essential nextjs Concepts like architecture rendering routing and its full stack features then

00:01:09 together we'll explore those Concepts directly within the code and finally I'll put your skills to the test by teaching you how to build an Enterprise ready application YC directory now this crash course will give you a great Foundation but if you're serious about mastering nextjs and taking your skills to a professional level I've got something special for you the ultimate next GS S course where we go beyond the basics and tackle next gs's most advanced Enterprise grade features is now on sale you'll learn everything from

00:01:40 optimizing performance and SEO to serverless architecture and handling realworld production challenges to become a full stack production ready developer check the description for more details on how to enroll if you're wondering if all companies are shifting to NEX GS and whether it's even worth learning the answer is a resounding yes at this point what major company isn't using nextjs big names like Netflix Tik Tok twitch Hulu notion Nike and even open AI are building their websites with it the nextjs hype is real and if you

00:02:14 don't dive in now you could miss out on some life-changing opportunities so now is the perfect time to impress potential employers and show them you mean business and how are you going to do that by actually building your own full stack NEX GS app that's packed with Enterprise features like performance and speed optimizations to achieve Lightning Fast first contentful paint SEO optimization and server side rendering strategies for high search engine rankings centuries performance tracking allowing you to monitor your app in real

00:02:45 time identify bottlenecks and resolve user issues quickly improved developer experience to ship apps faster a serverless architecture that will allow you to scale your apps easy management of all your apps content using sanity I'll also teach you how and when to implement CDN caching for improved performance and much more to always have employers knocking at your door but now have you heard of why combinator that famous startup accelerator that gave birth to so many popular apps we use every day like stripe Airbnb twitch

00:03:17 coinbase and even Reddit today you'll build your version allowing users to create and share their startup with the world once they submit it it appears instantly without needing to reload the page they can also search by title username or category to get instant results once you find the startup you like you can navigate to its details and see how many other people have found it interesting before you you'll integrate GitHub authentication via next off so users can log in create and submit startups with markdown support with a

00:03:48 dedicated profile page where you can find all other startups from that user you'll Implement all that using the latest nextjs features like PPR next after new forms server component HMR cache and server actions you'll also learn how to use the sanity content operating system an API based platform for structured content that pairs perfectly with NEX GS and other popular front-end Frameworks that companies like Shopify puma figma and tag group use to manage their content it lets you skip the boring Parts allowing you to focus

00:04:20 on what truly matters bringing your project to life sanity is doubling down on its role within the next GS ecosystem it has a very generous free tier and no credit card is required even better you'll get a free upgrade just because you're watching this video click the link in the description click get started go through a quick onboarding and you'll get your free upgrade so what are you waiting for let's dive right into the wait I have some breaking and exclusive news webstorm just became free yep you've heard that right that

00:04:49 professional web focused IDE with tons of features that used to cost like a hundred bucks per year is now completely free for non-commercial use and I'm not talking about a free trial or freemium but completely free I've been using webstorm for a long time and love its speed search G integration inline type suggestions and more so if you're a student hobbyist still learning or contributing to open source you can out try out all of those fancy features that used to be paid and prevented you from

00:05:20 using this powerful IDE click the link in the description and try out webstorm today let me start with a very important first question what does nygs have that react doesn't in simple terms nextjs simplifies the development process and optimizes your applications it does that through its primary functionalities some of which you have to actively decide to use and others that you get out of the box just by switching to nextjs along with the course I've also prepare the ultimate next gsse book think of it as a

00:05:57 handbook that covers everything you need to know to become a Prof professional nextjs developer from the nextjs road map Concepts and features to Advanced tips and tricks for building scalable projects you can build and deploy to put on your portfolio it's a premium and paid ebook with over 200 pages but I've made it entirely free for the first 1,000 developers that downloaded clicking the link in the description so don't miss out the first of NEX gs's benefits is its architecture originally react had two types of components

00:06:28 functional and class-based components but now components are also categorized by where they run if a component runs in the user's browser it's called a client component and if it runs on the server it's called a server component this division was released in react 19 and although Frameworks Like Remix and asro also supported nextjs was the first to adopt it and fully utilize it since server components are more performant nextjs automatically converts every new component you create into a server

00:06:57 component unless you specifically instructed not to only if you need some browser functionalities but more on that later the second nextjs benefit is in the way it handles rendering while react 19 supports server components nextjs extends them to more advanced rendering strategies allowing you to choose exactly where and when they'll be rendered optimizing the performance even further first is client side rendering which happens on your browser the server sends a basic HTML document and JavaScript code which the browser

00:07:26 executes to render the components and display the website and the second is serers side rendering which involves rendering the web page on the server before transmitting it to your browser when you visit a page the server processes and renders the components on the server and sends back fully rendered HTML and JavaScript code to the client instantly displaying the website but why does this matter well on top of the fact that your website will load in 300 milliseconds and have page speed insights that look like this service

00:07:54 side rendering will significantly improve your website's search engine optimization client side rendering makes it almost impossible for search engines to crawl and index your websites as they're completely empty nextjs solves this issue by sending pre-rendered code giving Google plenty of stuff to rank us on the next big nextjs benefit is of course routing in react you need to install an additional react router package to create routes on the other hand nextjs doesn't require installing a separate routing package and uses a much

00:08:24 more intuitive approach to routing called file based routing each folder's name becomes a routes path for example a folder named about will create a new slab route super simple right and connecting directly to the routing system the next best thing about NEX GS is its Evolution from a simple frontend library to a full stack framework using the same file-based routing system I just described you can also create serverless functions to handle native backend API requests this means you can create an API endpoint by simply

00:08:57 creating a file called route. Js in a specific folder without needing to worry about the server infrastructure NEX GS takes care of scaling automatically and there are many other scaling features that NEX GS provides out of the box like automatic code splitting while code splitting in react is possible it requires manual configuration especially as the application grows next GS automates code splitting by default well what does that mean it means that when a user navigates to a different page only

00:09:24 the code for that page is loaded which significantly speeds up page load times pretty handy right but that was just one out of many built-in performance optimizations that NEX GS provides font optimization reduces layout shift improves loading Time by pre-loading font files and reduces Reliance on external services like Google fonts image optimization automatically compresses images and applies lazy loading CDN support and more script optimization optimizes even thirdparty scripts and all of these gr

00:09:54 optimizations come right out of the box with nextjs and it's not just performance nextjs is the definition of Cutting Edge it supports the latest features such as react compiler MDX file integration managing most SEO related tags analytics that run without blocking UI fast refresh server components hot module replacement and more oh I know that was a lot right if you want me to slow down a lot and provide you with a deeper understanding of all of these Concepts like architecture and rendering I'd highly recommend checking out the

00:10:24 ultimate nextjs course it covers all important Concepts spread out throughout many modules and individual ual lessons and more importantly it also includes active lessons which require you to actively apply what you've learned up to this point the ultimate next GS course has secured its place as the best nextjs course in the world and from today it just got updated to the latest nextjs version so check it out in the description with that said if you're not ready to get that course yet that's totally okay stay with me and I'll teach

00:10:51 you everything I know about next GS in this crash course to get started create a new empty folder on your desktop and open up your terminal once you're there run MPX create-- apppp add latest and press enter after that press y to install the installer and you'll be prompted to answer a couple of questions for the project name just type do slash because we're already in the folder within which we want to create our nygs app in this case say yes for typescript yes for eslint yes for tailin CSS in this case

00:11:27 we don't need a source directory we definitely will be using the app router with its latest functionalities as well as the turbo pack which runs your application more smoothly we don't need to customize the import Alias the default one is fine and that's it your application will soon get initialized with all of the dependencies needed to run it there we go that was a success now that your project is set up and ready to go you'll notice many fs and folders so let me walk you through them from bottom to top the first one on our

00:11:58 list is TS config f.j Json this is the configuration file for typescript it defines what should be type checked ignored and the rules to follow next we have a Tailwind doc config.txt Tailwind by customizing colors sizes Shadows plugins or anything else you might need you know about read me right it's a simple marked done file that explains how to run the project next we have a post CSS config MJS it's a configuration file for post CSS a tool used to process CSS with different plugins in this case it uses tailin CSS

00:12:37 as a plugin which allows you to use utility first classes in your project package lock Json is a file that locks the version of dependencies and their subpena same versions package Jon is a bit simpler and it contains all the current dependencies and scripts there's a Dev script which starts nextjs in development mode with hot module reloading error reporting and more build creates an optimized production build of your app starts simply starts next GS in production mode and there's also lint which runs es lint for all files in the

00:13:14 source app directory and more finally you can also see three very important dependencies react react Dom and the current version of next by the time you're watching this video you should just be able to see 15 right here after after package Jon we have a next env. D.S which is a typescript declaration file for nextjs and as it says right here this file should not be edited it's specifically for nextjs on the other hand next. config.sys features such as experimental options image settings build settings

00:13:52 and more and you all know the good old get ignore it's very important not to miss adding something there thankfully next JS adds the EnV for us that's good no more leaked environment variables after that we have a lint rc. Json allowing you to configure your linting options then we dive into folders first we have a public folder which contains static assets always put your images and other static data here and then of course there's the node modules the heaviest object in the universe Jokes Aside it is a folder containing all the

00:14:27 dependencies or packages needed to run your application and finally there's the app folder the most important folder in every nextjs application in the app folder of course we have our primary homepage page. DSX but before we check out the rest of these pages in detail let's first run our application to see it in the browser I'll open up the terminal and press mpm run Dev this will run it on Local Host 3000 so open it up there we go nextjs get started by editing app page. DSX save and see your changes instantly well

00:15:06 this is the new version of the boilerplate page I like it you'll also notice something at the bottom left I'll tell you what that is later on but for now the page you've just seen is right here within page. DSX this file represents the homepage or the forward SL route of your site by default it contains some boilerplate code so let's remove it and return a single H1 that says welcome to next.js we can also give it a class name of text- 3XL if I save it and go back to the browser you'll see the changes instantly thanks to HMR hot

00:15:44 module replacement among the other folders that we have here the first one are fonts and this is where you can store your font files it's actually preferable to using something like Google fonts think of it as self-hosting your own fonts there's a favicon Ico it's a file that appears on your browser's tab then there's the global. CSS file where you can write all of your custom CSS or simply import tailin CSS after that we have a layout. DSX this is the main entry point for your application anything you do here will be

00:16:17 applied across all pages and routes that's why here we're importing the fonts the Styles and the metadata for example let's change the metadata from create next app to something like hello nextjs I've even added a waving emoji and even without reloading you can see the changes in your browser and I know many of you will wonder what kind of browser is this I'm using Arc you can check it out I like it quite a lot and finally we're getting back to the page. TSX where we initially made those changes that's it that's the most

00:16:50 important folder of your app and all of the changes that you make to your app will go inside of this app folder okay okay now that you're familiar with the entire nextjs application structure let's get our hands dirty at the start of the crash course I was telling you a bit about architecture where you can write two different types of components client and server components if you remember I said that every component you create nextjs will by default turn into a server component but is that really

00:17:20 the case here on the homepage we have a component saying welcome to nextjs let's add a conso log before the return statement consol log what am I I was about to start what am I server or client component but it looks like our AI autocomplete is having a bit of an existential crisis it's saying what am I doing here but yeah I'll just add server or client let's see which type of component is this by default we have absolutely nothing here just export default function home where we have a consol log and an H1 statement where do

00:17:56 you think this consol log will appear do you think will be able to see this conso log in the browser well up to this point I would tell you no it's not going to appear in your browser because this is a serverside component but would you look at this xgs steam knew that some of us might be searching for this cons log in the browser so even though technically it shouldn't be showing here they're still showing it to us but they have added this server tag at the top left so we know it's actually rendering from the

00:18:24 server pretty cool nextjs but if you actually knew what you were doing you would IM immediately go to the terminal to find your console log and here it is so now we know that this is actually rendering on the server server components are rendered on the server so this brings me to the topic of react server components they're the components that are rendered on the server and their HTML output is then sent to the client since they're rendered in the server they can access serverside resources directly like databases or

00:18:55 defile system this helps reduce the amount of JavaScript sent to the client improving performance server components are excellent when you need direct access to serers side resources like accessing files in a file system or you want to keep sensitive information well sensitive such as access tokens and other Keys safe on the server all right but if server components really are better why can't everything be a server component well if your component requires browser interactivity such as clicking buttons navigating to different

00:19:31 pages and submitting forms then you need to turn it into a client component so what are react client components client components are of course rendered on the client side and in this case client side simply means the browser to use them in nextjs you must add a use client directive at the top of the component in our case let's do that by creating a new folder within the app folder and call it components and within it create a new file called hello. DSX right at the top you can add that use client directive that I was telling

00:20:08 you about and then you can simply create a new functional component called hello that simply returns a div with an H1 that says hello and I've also added a console log saying I am a clan component see this one doesn't have an existential crisis it knows what it is now that you've created it let's go back to the page. TSX let's wrap this H1 within a react fragment allowing us to add another adjacent element in this case we'll simply import the hello component coming from at SLA SL components SLO now let's

00:20:47 check the terminal okay we don't see that conso log there but that makes sense right because hello knows it's a client component but if we go into the browser there we go I am I am a client component coming from hello. DSX but wait I think I initially missed it but now I see it I am a client component is so confident that it appears right here too but why or how is that happening well this is because server components are rendered only on the server side while client components are pre-rendered

00:21:21 on the server side to create a static shell and then hydrate it on the client side this means that everything within the the client component that doesn't require interactivity or isn't dependent on the browser is still rendered on the server the code or parts that rely on the browser or require interactivity are left as placeholders during server side pre-rendering when they reach the client the browser then renders the client components and fills in the placeholders left by the server I hope that makes

00:21:53 sense and that answers the question of what is serers side pre-rendering a pretty cool feature by nextjs I hope that's clear now but if you're still unsure take a second to pause it and rewatch it until it clicks you can also add some additional cons logs or components and then render them within the page. DSX don't proceed further if that doesn't make sense and for a deeper dive with clearer explanations and more visuals I would recommend checking out the ultimate nextjs course where I break down the entire client server

00:22:26 architecture in detail so finally when should you allow nextjs to turn your components into server side components and when should you manually change them to client side well A good rule of thumb is to leave it as server side component until you need some browser interactivity at which point you'll most likely get an error and then you can add the use client directive at the top but if you want to understand on a deeper level when should you use each one always refer to this table within the nextjs docs I'll make sure to link it as

00:22:57 an essential resource within the ebook that you can download this is the best table that simply explains when you need something to be a server or a client component depending on what you need that component to do now it's time to dive into routing nextjs uses a file based routing system and doing everything on a single page is boring right currently we only have one route which is the homepage so how do we create a new route like forward slab it is as simple as creating a new folder and a file

00:23:29 in the app directory create a new folder and name it about and within that folder create a new page. TSX file within there you can create a single functional component that returns a div that says about now go back to the browser and simply add for slab to your URL and if I zoom it in a lot there we go the route is being displayed this is how you create routes in xgs it uses an intuitive file-based routing system where folders are used to define routes the folder name becomes the route name and the page that the aect inside of it

00:24:11 becomes a file that gets rendered for that route it's a special file naming convention for displaying that route's content but in most cases that won't be enough you'll need nested routes let's say you're developing an admin dashboard within this application and you want to create a Route 4 dashboard users and dashboard analytics of course you can't create two folders with the same name this is where nested routes come in handy let's create a new folder called dashboard inside of which we'll create

00:24:43 two additional folders one will be called users and another one will be called analytics and both of them will contain a special page. DSX file there we go you get one and you get one too within them we can simply run our afce if you don't have that Quick Command you can install it as a package it's called react Snippets and then within this one we can call it users we can duplicate that and we can also add it within analytics and if you go back to your browser go to forward SL dashboard slash users you can see users

00:25:23 and if you go to/ analytics you can see analytics but of course if you go just to dashboard itself it's going to be a 404 here's a quick question for you do you know how you would create a separate dashboard homepage if you wanted to the answer is simply add another page. DSX within the dashboard folder itself yes you can have a dashboard page and then dashboard nested routes but this still may not be enough in many cases you'll also need Dynamic routes what if you want to display each user's profile in

00:25:58 the dashboard let's say we have four predefined users in the dashboard users page that's going to look something like this users with in div and then we have an H1 and a UL with four different users now let's say you want to show full user details on the page when you click on each one of these users say we want to direct them to dashboard users user one and then dashboard users user 2 and so on we can't create these folders manually as we don't know how many users will there be this is what dynamic

00:26:33 routing is all about a route where part of the URL can change or be dynamic typically based on the user input or specific data in the database creating Dynamic routes in nextjs is simple all you have to do is wrap the part that changes that is dynamic in square brackets in our case it'll be the user ID so let's create a new folder called ID within the users folder and make sure to wrap it within square brackets that's the rule inside of that file create a new page. TSX and run RFC to create a generic user Details

00:27:16 page now let's go back to the users page and let's make these users clickable doing that is pretty simple we just have to use NEX gs's link component it looks like this you import it from next SL link you give it an hre to where you want to go and in this case let's make it point to dashboard slash users slash1 and let's say user one we can of course duplicate this a few more times so let's put it within an Li and properly close it and 1 2 3 there we go and we can also change their name GES 2 3 4 now if I go

00:28:01 back to the browser I can actually click on these links and look they let me to the user Details page but they all do right three four they're all relating to the same user Details page or the page is technically different because right here you can see it says users one and if you go to users 2 it's going to say users 2 but how do we extract the different information about each one of the the users let me show you I'll go back to user Details page and we can extract this Dynamic parameter from the

00:28:36 folder from the params object you destructure right here at the top of the function and then you say params since we're using typescript we also need to define the type of the params it'll be an object containing a single ID which will be of a type string and how do I know that it will contain a single property called ID of a typ string well that's because we called this Dynamic route ID by saying ID within square brackets if you said something like name here you would be able to extract it by saying something like name in this case

00:29:11 let's destructure the ID from pams by saying const ID is equal to pams or you can also use the dot notation saying pam. ID finally now we can say user profile and then we can show the actual ID let's actually turn this into H1 and give it a class name of text- 3XL so we can see it better now if you go back you can see user profile 2 user profile 3 4 and so on and in real life this would work exactly the same you will always be fetching just the user ID but then from that page you can make a call to the

00:29:52 database that'll give you all the other user information such as their Avatar full name username and more more so now you know what prams are and if you want to get access to this information such as this ID elsewhere and not within an xgs page you can use a client component hook called use params that lets you read routes Dynamic parameters filled in by the current URL next let's learn about layout earlier I told you that the layout. TSX file is the main starting point of our app to demonstrate this let

00:30:25 me add a text of root before run in the children I'll do that right here and once again I'll make it H1 with a class name of text- 3XL and I'll say root now if you check out the homepage it'll say root welcome to nextjs then if you go to slab you'll see root about or if you go to dashboard SL users if it doesn't appear automatically for you you might need to reload your server by opening up the ter Al pressing contrl C to stop it and then rerunning mpm runev but you get the point rout appears on

00:31:06 top of all the pages this is because layout. TSX acts as the parent for all of these routes it allows you to share UI elements across multiple Pages for example you can place features like a navbar or a footer in the layout and they'll appear on all children routes saving you you from having to import them on every page simply add them once in layout. TSX and they'll be available wherever needed in nextjs a root layout is always required but you can create additional layouts if necessary let's say you want to render a

00:31:46 specific UI just for the dashboard routes we can do that by adding another layout. TSX right here within the dashboard the name has to be layout don't try something else otherwise nextjs won't recognize it creating a new layout is as simple as creating a new functional component and then getting children right here just to make typescript happy you can also Define additional types such as children is equal to react node and you might need to import react there we go now everybody's happy within this div we can then render

00:32:24 children and the children in this case will be all other pages that you showing within this layout but if you want to add some kind of a special dashboard nav bar so let's say dashboard then you can add it to the layout and let's also apply the same styles by giving it a class name equal to text- 3XL so now if you reload you can see root this is coming from the root layout and then dashboard is coming from the dashboard layout just imagine that these are different pieces of the UI that we're showing on different screens so

00:32:57 dashboard users and dashboard analytics has both root and dashboard but as soon as you exit the dashboard route group you're back to just rout I hope this makes sense but there's more route groups let's say you don't want the rot layout to appear in the dashboard routes and only show up in non dashboard routes like home about and more this means that you'd need a separate nav bar for the dashboard and another one for the non- dashboard routes that's pretty similar how things work in real life right in

00:33:31 such scenarios you can use route groups they allow you to organize your route segments and project structure without impacting the URL path this means that you can create folders but unlike nested routes they won't show up in the URL you do that by wrapping the folder name inside parentheses in our case let's create two different folders one will be called dashboard in parentheses and the other one will be called root in parenthesis as well now move the dashboard folder within the dashboard in parenthesis and move the

00:34:09 homepage and the about folder in the root now remove the root from the root layout file this let's say this is a root navigation bar and add another layout. TSX file within the root route group once again it is a single functional component that accepts children and then now you can render the nav bar right here so let's do an H1 and this case let's give it a class name equal to text- 3XL and let's simply say navbar and you must render children in every layout file so let's render them below and one last change is to move the

00:34:49 layout. TSX from this dashboard folder to this dashboard folder right here now each route group has its own layout now if you go back to the website you'll see everything is as it was we have nav bar on top of the home and slout Route and if we go to dashboard and then users you can see that we have only a dashboard navigation bar everything works as expected so why are we using these route groups in the first place well take a look they're making our code more organized without affecting the URL

00:35:28 to go to the homepage or to the about page you don't have to say forward SL root forward slab you simply say about so whenever you place a folder name within parenthesis that means you're creating a route group and it will not be map to a URL path and why is this useful well one for organizing your code you can see everything is cleaner now and the second reason is that you can have separate layouts for different route groups which are going to give you different UI but without affecting the URL so let's rewind one more time route

00:36:04 groups allow you to create folders without affecting the URL and even though creating route groups isn't taken into account you can still create files like layout. DSX inside of them and it's important that this Ru route group still points to the homepage so this page right here is the primary homepage if you were to copy and paste this file into the dashboard that would work because now we have two parallel routes that resolve to the same path I hope this is clear understanding route groups is extremely useful because they allow

00:36:38 you to separate concerns manage route segments and render content properly all without showing them in the URL next let's talk about airor handling in nextjs there's a special file called error. JS or TS if you're using typescript that catches errors and and displays them on the UI similar to how we were able to create multiple layout files for each folder be that a route group or a route folder we can do the same for the error. TS file let's throw an error on purpose in the about page I'll head over to that page and I'll say

00:37:16 Throw new error I'll say something like not implemented and don't forget to delete this duplicate of a p TSX within the dashboard that one is still throwing as the old error once you do that and go to about you'll see an error that is fine for as developers but you never want to show it to the end user rather if there has to be an error let's show it within a nice UI at least the user will feel better that way to do that let's create a new error. TSX file in the root folder error. TSX in it I'll copy the

00:37:53 code provided to us by the next year's documentation this component is is nicely handling the error save and revisit the about page check it out we don't see that red popup anymore rather we see what we have implemented in the error. TSX file something went wrong try again super simple and straightforward to handle errors in xgs right and as I said you can even create these error files specific to different routes if you just want to have one Global error then you can do it by creating a global

00:38:27 error TSX file in the root of the app folder that's going to look something like this I'll go into the app and create a new file called Global error. TSX the code will look something like this I'm not sure why my indentation is not working when copying but you get the idea you can specify the HTML and the body and simply show some kind of an error take a note that error boundaries must be client comp components now going back to our app can we see this error well not really unlike layout. TSX which

00:39:05 displays everything from its parent the error file Works differently only the closest error file to the route takes priority meaning you won't see the content both from Global a. TSX and from the root error TSX errors will bubble up to the nearest parent error file not all of them make sense and to talk about something else other than errors let's talk about loading uis loading uis in nextjs works very similarly to error handling you want to show some kind of a loading progress while data is being fetched for users

00:39:44 with a slow internet connection it is as simple as adding a new loading. TSX file in the folder in there you can create any kind of a loader or a Nic looking spinner now as your page reloads this file will show I'll keep reloading the screen so you can see that loading bar adding loadings to your nextjs really doesn't get simpler than that while the data is loading nextjs will show the content you specified in the loading file and once the data is received the content in the page you're trying to

00:40:19 render will be shown it's super useful and surprisingly easy to do I've covered this in more detail in the ultimate nextjs course as you can see here there's an entire section dedicated to it complete with challenges to help you practice but in this crash course you'll also see this in action in the next segment where we'll actually do some real world data fetching and in addition to these main file conventions like page layout error and loading nextjs also provides other features like parallel

00:40:50 routes intercepting routes and localization routes that display content based on the user's language you can explore all of these in the next GSS documentation but for now let's move over to data fetching the most interesting Concept in nextjs there are different ways in which we can fetch content a traditional way is using a use effect for example this is what you would do let's say that you have a homepage where you're trying to set and fetch some albums you create a new empty use State you declare a use effect

00:41:27 Within which you declare an asynchronous fetching function within it you have an await fetch where you're trying to get some albums and then you return that Json and set it to the state finally going a bit down you map over those albums and show the data but this isn't super efficient there is a better alternative to fetch and it's happening on the server side not only is it faster and more efficient the code is also so much cleaner check this out you declare a new functional component called home and immediately on

00:42:02 top of it you make a fetch request you check if it fails if it doesn't you simply declare it and set its response. Json to the album's variable you map over it and display the details go ahead pause this video and test it out you don't necessarily have to do all the Styles but you can at least try to fetch the data map over the albums and show each album title if you do it visit the website and see if it works you'll not see anything you'll have to refresh to see the result and it's not because HMR

00:42:37 is not working but rather HMR is caching your content in latest versions of nextjs there is a new feature called server components HMR cache that allows you to cash fetch responses in server components across hot module replacement refreshes in local development ment what this means is you'll have faster responses and reduced costs for build API calls but now coming back to the difference between server side fetching versus client side fetching first of all you'll notice the code difference between the two strategies with server

00:43:14 side fetching you wrote fewer lines of code which improves the DX developer experience but that's not the only benefit server side fetching has so many more benefits like improved initial low time as a server side data fetching allows the page to be rendered with the data already included it reduces the time to First contentful paint FCP in the client side example the user sees an empty page until the data is fetched and then rendered the second and most important benefit of server side fetching is better SEO search engine

00:43:52 crawlers can more easily index content rendered on the server as the content is already provided in HTML format in contrast client side fetching may result in content not being visible to crawlers right away since it first needs to be fetched and then displayed on the UI which can negatively impact your SEO next not only is the code shorter but the logic is simplified server components allow you to keep data fetching Logic on the server closer to your data source this can simplify your component logic and

00:44:28 reduce the need for use effect and use State Hooks and the next benefit is not that easy to understand that first and it is automatic request D duplication nextjs provides that automatic request D duplication when fetching data on the server which can improve performance and reduce unnecessary API calls basically request the duplication makes sure that when the same data is requested multiple times at once only one request is sent it stops duplicate requests from being made and when talking about benefits of

00:45:04 the server side fetching versus client side fetching I really can't miss on improved security keeping API calls on the server allows you to better protect sensitive information like API Keys which should never be exposed on the client side and adding to the list of benefits we have reduced Network waterfall client side data fetching often leads to to a network waterfall where requests are made sequentially server side fetching can more efficiently parallelize those requests I'll teach you how to do these parallel

00:45:37 requests in our build and deploy project so keep watching but this isn't just about fetching you can server render any other calls maybe a direct database call to Prisma to get the list of posts or even with Mongoose and mongodb like this that's the beauty of nextjs this is achievable because these components are react server components which allow you to access server related resources directly this means we can make direct database calls instead of needing to create an API and then fetch that API once again and if you're still

00:46:15 not convinced you can always go for client side fetching how just add Ed client to the top bring back the use effects the use States and you're all set nextjs will allow you to do whatever you think is is best and let's be honest this is how we all used to use next GS when we first transitioned over from react it only feels natural but it is the wrong way to use nextjs and that's what made me create the whole ultimate nextjs course in the first place to teach NEX GS the right way but now take a moment to test both client side and

00:46:50 server side rendering you'll notice the differences I mentioned such as seeing the blank page initially with client side rendering or if you inspect it source and see that nothing is there or client side not functioning at all if you disable JavaScript in contrast serers side fetching will still display the results even if JavaScript is turned off in the browser but now that we know that serers side fetching is preferable let's explore different server side strategies that allow you to manage how

00:47:20 and when you render your content on the server side you see this is a crucial part of nextjs and I know that some of you might be thinking I just want to code already but without understanding these Concepts you'll probably end up saying I hate nygs it never works the truth is it does work just not for you you just need to write skills to make it happen that's why even on my platform I dedicate an entire section to breaking down these strategies before we touch a single line of code and we'll be doing

00:47:54 the same thing in this video trust me it'll will make your life a whole lot easier the first technique is static site generation or SSG a technique where HTML pages are generated at build time this means that the content is created when you deploy your site not when a user requests it it's extremely fast and can be served from a CDN but it's not suitable for websites that need frequently updated content by default xgs uses a static rendering strategy your result is cached and delivered through a CDN Network

00:48:34 ideally you want to use this strategy for blogs documentation sites or marketing pages but in many cases you'll have to go for incremental static regeneration or ISR for short it's an extension of SSG that allows you to update static content after you've built your site this means that it'll create static p PES and build time behaving like SSG and then after some time has passed it'll create or update those static Pages once again after you've deployed your site basically it combines the benefits of static generation with

00:49:13 the ability to refresh or update content if you want to use ISR as a strategy you can do this in two ways the first one is time based revalidation you can revalidate your entire page after some time by simply exporting a variable called revalidate and set it equal to the number of seconds of when you want to revalidate isn't that crazy expert cons revalidate and then that changes your rendering strategy super simple and the second way is to revalidate the request after some time and that would look something like this you have a

00:49:49 Fetch and then you provide the options object with next revalidate the difference between these two is that the first approach uses the revalidate export which is a route segment config it sets the revalidation time for the entire page to 3600 seconds or 1 hour this means that the entire page including all data fetches within it will be revalidated every hour while the second approach uses the next revalidate option in the fetch function it sets the revalidation time specifically for this data fetch to 1 hour this means that

00:50:28 only this particular data fetch will be revalidated every 3600 seconds while other parts of the page or other data fetches if any are not affected at all and there's also OnDemand validation instead of doing it on time you can also revalidate using revalidate path and revalidate tag for on demand validation of content I hope that's clear enough that's how you can use ISR are it's perfect for those websites whose content changes occasionally but still doesn't need realtime updates the next rendering

00:51:05 strategy is server side rendering or SSR it generates the HTML for a page on the server in response to a user's request this means that the content is created dynamically for each user request and not only for each deployment it's slower than SSG and puts more load on the server but you'll always have up-to-date content this is ideal for highly Dynamic content or pages that need real-time data similar to what we did with ISR you can use the same configs for SSR for timebase revalidation instead of setting it to

00:51:44 some random number of seconds you simply set it to zero telling nextjs to render the page every time the user requested and if you only want to do it for specific requests you can use the cash no store or or set the revalidate to zero there and same thing happens with the on demand validation like revalidate path and revalidate tag you can learn more about them in the documentation but so far everything is super intuitive and finally there's the partial pre-rendering PPR it's a new rendering model that combines static and dynamic

00:52:20 rendering it allows you to render a static shell of a page while streaming Dynamic content the key key difference with PPR is that it allows for a hybrid approach within a single page unlike other strategies that work on a page level here's how PPR works during build time nextjs generates a static shell of the pages this shell includes the layout and any static parts of the page in the form of components this static shell includes placeholders for dynamic content we do it by wrapping Dynamic components in a suspense tag when a user

00:52:59 requests the page the static shell is served immediately and then the dynamic content is streamed in as it becomes available so what does this mean well with PPR you can have static components Dynamic components and components that are partially static and partially Dynamic depending on what you need you'll actually learn about all of these strategies in action in the application you'll develop today so for now now let's keep going we're almost there and ready to start building the app but first I have to tell you a bit about API

00:53:35 routes enough with front-end stuff optimization caching performance and all that it's time for some backend work if you've ever done some backend even creating a simple hello world from server message requires a fair bit of setup it involves setting up a project installing necessary packages like Express for node right writing server code setting up Express the port and then making that Port listen running it and then deploying it using some paid or free service so you can finally use it on the front

00:54:07 end it might not seem like a big deal when you're just reading or looking at the code but things quickly start getting complicated when you have to write various routes middle Wares and so on but in the newest version of next GS it's super simple much closer to what we did on the front end you just create a special file within a folder for the specific route and you're all set there's no need to set up manage or monitor an active server separately if you want to show the same message hello world from backend in nextjs you simply

00:54:39 need to create a folder with any name and then create a special file named route. DS inside it from there you can immediately begin writing server code export async function get return response. Json message hello world from backend that's all there is to it your folder name serves as your API route name with your business logic neatly encapsulated within this special route file if you now go to the browser modify the URL and add hello world to it you'll see Hello World from backend as a response but how can you create other

00:55:19 API endpoints like post patch delete and more well for that let's create a book endpoint with a local array as a database a common practice when creating route handlers is to create a folder called API and write all the routes inside it so create this API folder in the app directory and add a database file for storing some dummy books then you can create two routes get and post in app API books route. TSX these are nested routes similar to what you explored previously in the routing part the UI for the delete and

00:55:58 put you'll have to create Dynamic route handlers and you already know how to do that app API books and then Dynamic square brackets ID SL routts and inside of it you can export async function put for the update request and then export async function delete for the delete request and then you can add the logic so far this feels good similar to what we did with UI routes but this time for writing server code and creating apis so let's test them one by one to see if they work or not and there you go

00:56:37 everything works perfectly this is how route handlers or apis work in nextjs it's super simple and straightforward and the creation of apis in nextjs was nice but how can you use them on the UI well it's a simple fetch just create a books route real quick and call the get API route to fetch the content const responed await fetch Local Host 3000 API books you get them from the response send them to the state and render them if you visit the books route you'll see all of your books as easy as it could be

00:57:14 thanks to the serverless architecture of NEX GS and react 19 react server components and there's one final thing I want to teach you before you're ready to start creating your next GS application and that is search engine optimization specifically how we use metadata in nextjs to improve our SEO and when I mention metadata I'm referring to the look and feel of our website when we share it with others on messenging platforms or posted on social media platforms or on internet in general like for example in search engines in today's

00:57:50 world we need to ensure that our content is sharable so there are two ways in which we can manage met data in our nextg application the first one is config based all you have to do is create a JavaScript object into the layout or any kind of page file and Export it nextjs will automatically detect it and turn it into relevant meta tags for those routes something like export const metadata is equal to and then in there you can provide all sorts of different SEO properties such as title description thumbnail and more we

00:58:26 already already have a config file in our app layout. DSX however if you navigate over to the homepage and add an additional metadata something like home next GS then that one will be taken into account because it's higher on the priority list and it'll override the default specified in the global layout this allows you to either define unique metadata for each route or rely on the metadata from the root layout it's entirely up to you but everything with this discussed so far is just static metadata means that it's not going to

00:59:00 change home is always going to be home but there also going to be cases in which you want to create Dynamic metadata based on some kind of content on the page such as a Blog title for example let me show you how I implemented this strategy on JS mastery. proo for the resources page on the main Resource page you'll see different titles and descriptions and if you click on one of the resources you'll see a change in the title and description as well same thing happens for the other resources each has its own title

00:59:32 description and image which helps web crawlers index these pages and makes them much more sharable on social media but how can we achieve this in xgs it's super simple the only thing you have to do is export a new async function called generate metadata which gets access to params pams being the same pams that we had before from dynamic routes you can extract the ID or the name or anything else based on that ID you can get full resource details or user profile details whatever it is then you can use those details to formulate

01:00:11 SEO title descriptions thumbnails and more and you can simply return a dynamic object of all of these properties that's it as simple as that are you with me so far good and the other way in which we can set metadata in nextjs is file based metadata as the name suggests you can put files like a robot sitemap favicon open graph images or other site icons directly inside the app folder and nextjs will automatically detect and generate corresponding meta tags for example you can have an app and then a

01:00:48 favicon and then an icon and then an open graph image Twitter image all of these properties will get added to your metatags it's just about adding the files with the right names they have to be proper names directly inside the app folder it'll work out the same as the config based approach you can find a full list of all files that can be created to Define metadata here but for the time being I still prefer creating it by exporting the config file from layouts or individual pages and it's worth noting that file-based metadata

01:01:23 has a higher priority and will override any config based metadata so if you set it in a file it'll be used instead of the ones that you set in the configuration so now you know how to make your apps sharable SEO optimized and search engine cable with that in mind I think you're ready first there was a lot of theory and then there was more Theory disguised in this practical part but now you're ready to dive into code you're ready to Dive Right In and build and deploy your nextjs app with all of these optimizations performance

01:02:00 updates and new features baked right into it application you will develop and deploy along with the specific nextjs features you'll use on the homepage you'll find a list of startups fetch directly from sanity and the great part is that whenever someone anywhere in the world submits a new startup it'll instantly appear for all the other users here without needing to reload the page you can also search for any startup by title Creator name or category in real time in this case let's go with category

01:02:32 of Health you just click it right here and you can see that search works instantly for this we're using next gs's latest next form feature which automatically manages the URL State and allows form submissions via keyboard events with minimal code required now if you click on any one of these startups you can view its details including the title date when it was published a description thumbnail more information about the author and then finally the pitch details in this case we just use regular text for the details but if we

01:03:05 go to another post you can see that it supports full markdown capabilities and at the bottom we have some other recommended posts but maybe the most important part of this entire pitch Details page besides this great looking image of course is the number of times that this post has been viewed and you can see that right here at the bottom right even though it might feel like a small feature it's actually quite significant here you'll be using NEX gs's latest rendering strategy known as PPR partial pre-rendering with this

01:03:37 approach everything except the view counter is kept as static content for 60 seconds using incremental static regeneration while the views counter is handled with server side rendering this means that whenever a user requests a page most of the details are served from the CDN cache but the views are recalculated with each request and aren't cached that is what PPR is all about giving you control over which parts of the page remain static and which are regenerated dynamically we're also applying the same strategy on the

01:04:10 user profile page where the user details are cached but the content such as submitted startups is always generated fresh with each request this ensures that the latest data is displayed without caching using the PPR approach to to submit a startup you'll need to create an account first by signing up with GitHub using social authentication I already authenticated before so you'd log me right in you'll do this using the latest version of next off and once you signed in your account will be stored in sanity and you'll be

01:04:41 able to go over to the create startup page here we're utilizing react 19's highly anticipated use action State hook along with nextjs server actions all Fields right here including the image URL are val validated using Zod ensuring that no validation is kept now I'll split my screen in half keeping one side on the homepage and another one on the startup creation page I've entered some details and I'll go ahead and submit my pitch the second I click this it's submitting the success I got rated and

01:05:16 check this out immediately without a Reload this startup appeared right here on the homepage that's how real time updates work and I'll teach you how to do it isn't all this amazing pretty cool app that purposefully features so many of the new NEX GS features so now let's build it together and let's explore everything that next GS has to offer to develop this great application we'll use react but not just playing old react will power it up with nextjs specifically with the latest and greatest of what nextjs has to offer

01:05:51 even though nextjs comes with many built-in optimizations as you might know if you watch the crash course I'll also teach you how to use it to the fullest potential by handling things that are not coming out of the box such as implementing Dynamic HTML streaming react server components many different ways of data fetching depending on the use case client and server rendering and much more for styling we'll of course use stnd CSS a utility first CSS framework that allows you to style your applications very quickly but still

01:06:22 gives you the possibility to keep your design completely custom and on top of tailin CSS we'll also use shaten a component library that provides you with the necessary components that you can simply copy and paste into your apps finally I know you've been waiting for this day you'll Implement o from scratch using next off specifically we'll do a GitHub integration and on top of all of that I'll teach you how to manage the content of your application using sanity so with that in mind let's go ahead and

01:06:56 and set up our new nextjs project to get started create a new empty folder on your desktop name it something like YC directory and then open it up within your code editor within it open up your terminal run MPX create-- apppp at latest. SL to create it in the current repository it's going to ask you a couple of questions and we just want to press enter for all of them since we'll be using the default recommended options of course we would like to use typescript to make her project type safe we would like to use

01:07:29 eslint to make sure that our codebase is clean Tailwind CSS sign us up no need to put everything inside of the source directory just putting it within the app is fine we will be using the app router turbo pack for smoother development environment no need to customize the default import Alias and that's it the packages are getting installed there we go our project has been initialized but before we run it there's one more thing we have to do head over to your package.json and here you can see that

01:08:01 we're using the latest versions of react as well as nextjs but we also have to make sure that all the other packages and dependencies that we use such as next o also use those latest versions and not go back to using react 18 for example for that reason we have to add two additional properties to our package.json let's add it right below the scripts one one is to set a specific version of your package manager in this case I'm using mpm so I'll set it to mpm at 10.5.2 and then also set the overrides

01:08:37 react dollar sign react and react Dom dollar sign react Dom this will ensure that the latest versions of react are being used across all the packages in your project and after you do this make sure to not delete node modules and then reinstall them because that might break some things if you were thinking of doing that then just copy the exact versions of react and react Dom and put them right here in the overrides in that case it'll work great now that we have done this we can simply run mpm runev to

01:09:07 see the server in action so let's open up the terminal and say mpm runev and there we go our application is now live on Local Host 3000 which means that we are ready to start developing it this time we'll start straight with Authentication which we'll be implementing using OJs or also known as next o so let's head over to installation and we'll choose nextjs of course first things first we have to run the installation command so let's copy it and I've opened up a new terminal inside of which we can run those

01:09:43 installation commands so let's install it there we go that was super simple next we'll have to set up the environment by setting up our off secret so let's copy this command and run MPX off Secret press y to proceed and this just created a newv local with your odd secret next we'll have to implement our configuration I'll Zoom this in so you can see it a bit better but you can also follow along with your own docs the goal of these videos is for me to teach you how to replicate what I'm working not

01:10:13 just follow along so sometimes it's totally okay to pause and try to implement things on your own next we have to create the ajs config file and object this is where you can control the behavior of the library and specify custom authentication logic adapters and more create an off THS file in the project here we can pass all the custom authentication options so let's create it in the root of your app and copy this config now there directly in the root of your application create a new file called

01:10:46 O.S and paste what you just copied import next o from next o and here we're exporting a next o object with the complete configuration next we'll have to add a route Handler under app API o and then we'll have to make this a new Dynamic rout so let's do just that I'll create a new folder within the app folder and I'll call it API within the API folder I'll create a new folder called off and within the off folder I'll create another folder which is going to be a dynamic one so we'll use square brackets dot dot dot next off

01:11:26 and then I'll close it like this and within it we'll create a new route. TS file within the route you can copy and paste this code import handlers from at slof and then we export those handlers the third step is an optional step to add the middleware in this case we'll skip it and next we have to set up the authentication methods the basic setup is complete but now you can choose the providers which you want to allow your users to authenticate with so let's head over to authentication and go to

01:11:58 ooth here you can jump to one of the most popular providers for authentication we typically do Google but now I'll do GitHub on this documentation page you just get a call back URL that we need to call but in this case we need to set it up from scratch so let's go over to connections providers and then here search for GitHub there we go and here you'll get all the information how we can create a new GitHub oov app which we need for this setup so head over to this documentation page and here you get the

01:12:28 steps needed to create a GitHub OA app you have to go to settings developer settings allo apps and then create a new allo app and then add the authorization callback URL so let's do all of that together head over to github.com go to your profile go to settings head over to developer settings right at the bottom left and then don't create a new GitHub app rather head over to oov apps and then create a new oov app enter the application name such as YC directory and you'll have to enter the homepage

01:13:05 URL for the time being we don't really have a URL yet because it'll be rendered on Local Host so let's just say Local Host 3000 right here we can switch it later on once we deploy our application application description well this will be a directory for the new era of startups I like that and authorization call back URL to know what we need to put there we can refer to next odds documentation so let's simply copy this and then paste it right here in this case we'll use Local Host 3000 as the URL and click register well

01:13:45 yeah this is the thing now it's asking us to have a real homepage URL which starts with HTTP or https so if you just add HTTP col SL slash and press create it'll work great and now here we got a client ID and we can generate a new client secret so let's copy the client ID and add it to our env. loal We'll add it as o uncore GitHub ID and set it equal to this string similarly we can generate a new client secret for that you'll have to confirm access and once it's generated copy it as you won't be able to see it again

01:14:26 once you do that you can say o GitHub secret and set it right here if you want to you can also upload your apps logo and that's the perfect time to refer to the complete figma design for this project the link is down in the description just enter your email and you can get it immediately once you're there you can explore the entire design and you can get this logo simply double click it and then export it right here once you export it you can upload it here I'll use just YC perfect let's update our application

01:15:02 and we'll revisit this page at the end of this video to put our new deployed URL right here but for the time being we can go back to the next odd setup and we can copy the configuration the only thing this is doing is updating our existing aths file where now we are adding a GitHub provider right within it so how do we make it work well let's go back to our homepage let's remove everything we have from this home right now I'll keep just a single react fragment right here for now completely empty we can simply say home now we can

01:15:35 improve our file and folder structure currently our homepage is right here but I actually want to organize this a bit and create a new route Group which is going to be called root so these are all our homepages I'll move this page over to this rout and I'll also create a new layout file right here layout. TSX that means that what we apply to this layout will only be applied to the pages within this route group so let's say export default function layout it accepts children as a prop and we need to define

01:16:11 the type of that children and we'll set it to read only because we're not going to modify it and then you can say children is of a type react. react node finally we can return a new main tag with a a class name equal to font DW work- sense so this is a special font we'll apply later on then as you know within every layout we need to render the children but what this specific layout will do is it'll render a Navar right here on top of it so let's create a new components folder and within it let's create a new file called navbar

01:16:50 TSX let's run rafc within it to create a react Arrow function component and if this didn't work for you that must mean that you don't have the necessary plugin the plugin I'm using is called modern react Snippets so just install it and it should work once you do that we can go back to the layout and we can autoimport this SV bar as a self-closing component right here so now we have the nav bar we have the layout and we have the homepage let's actually turn this home into an H1 that will say home and we can give it a

01:17:22 class name equal to text Dash to excel to make it a bit larger now if you go back to Local Host and you reload you should be able to see the Navar at the top and then home right here below it that's perfect because right within the nav bar we'll Implement our next off let's style it just a bit by giving it a class name equal to padding xl5 to give it a bit of spacing on left and right padding Y3 to give it some space on top and bottom BG white shadow DSM for a small shadow and font DW work- sense and

01:17:57 that's going to be within an HTML 5 semantic header tag within which we can render a nav tag with a class name equal to flex justify Dash between items Das Center within it we can render a nextjs link tag with an href pointing to forward slash meaning it's going to go just to the homepage and within here we can show our logo that's going to be a nextjs image tag with a source equal to/ logo.png an Al tag of logo a width of about 144 pixels and a height of about 30 pixels if we save this currently the image will

01:18:39 not load that's because we don't yet have it in our public folder so let's remove all of the files from the public folder that we have there right now and let's get the logo directly from figma you can export it as you already know you can drag and drop it from your downloads and then you can just rename it to logo.png if you do that there we go now we know that you're starting to build the YC directory moving forward we're going to go below the link and we'll render another div with a class name

01:19:12 equal to flex items Das Center and a gap of five within here we only want to render things if our user is logged in so so how can we know whether a user is logged in well we can look into a user session that is coming directly from next off so let's say con session is equal to await o which we have to import from at SL off and since we used a weight here we need to turn this into an async function and we can do that because this is a server rendered component how cool is that you would never be able to do this in client

01:19:54 components so so now that we have the session we can do a quick check and say if session exists and if session has a user then render this additional information about that user or give them the possibility to perform some actions such as a link that will have a span within it and it'll say something like create it'll also have an hre of slst startup slre pointing the user to that create page and below the link link will have a button with an onclick property equal to sign out and this is something we have to import from o so

01:20:35 let's get O Let's Get sign out and let's get sign in as well so in this case we want to Simply sign out within the button we can create a span and say log out finally we're also going to have one more link which will point to the user's profile so let's say href is equal to Dynamic URL of sluser SL sessionm mark. so we want to go to the ID of that specific user for the time moment within it we can simply render a span which will render a session question mark. user question mark. name and since I

01:21:14 opened up a tary operator right here we also need to provide a second half of that operation what happens if we don't already have a user and in that case I'll create a button with an onclick equal to sign in and when you call sign in you also need to pass the provider in this case it'll be GitHub this button will have a span which will say login if I save this and collapse her editor so we can see the browser at the same time you should be able to see the button on the right side but it's barely

01:21:50 noticeable because the color of the font is not dark so on this D let's simply give it a text- black property and there we go we can see a login button because our session has not yet been established and before we go ahead and click it you can see that our on clicks are complaining both this one and this one here if you hover or sign in you can see that it's saying missing a weit for an async function call yes sign in is asynchronous meaning we have to add a weight in front of it so if I do that you can see that that's

01:22:27 not really a valid syntax that means that we have to turn this into a server action let me show you how I'll create a new callback function right here and then wrap this call within it makes sense so far right then since we're using a weight I'll add a sync right here and I'll add a use server directed right here which will ensure that this gets called on the server but but if you click login no luck we still get an error and this one is a bit weird but essentially what it's saying is hey you cannot use a server action within a

01:23:08 component that is maybe the best example of a client component a button with an onclick so let me show you what you have to do instead actually you'll be using the latest react 19 server actions with a new form feature you can pass a server action to a form and automatically submit the form to the server this is quite new so bear with me essentially you define an HTML 5 form give it an action which can be a server action and it'll execute on the server and I also have an example from nextjs docs saying that react extends the HTML

01:23:48 form and you can provide a server action with the action prop so let's explore it in action no pun intended and I'll turn this onclick into an action specifically it is an asynchronous server action trying to sign us in now within it I can render a button that'll have a type is equal to submit it'll simply submit the form and we can say something like login right here now if you press the login button check this out we got redirected to GitHub authentication but we get a bit of a warning saying that the redirect

01:24:26 URI is not associated with this application pointing to a slight misconfiguration believe it or not the fix is in one single letter sometimes issues like these are the worst just go back to your oo setup scroll down and then go to the authorization callback URL I copy this over from next off documentation and here they have a live deployed URL under https security but Local Host by default is HTTP security so let's put it like this go back to our app and click login and there we go we can authorize YC directory so let's

01:25:08 click authorize and for the second time we get an error that you now know how to fix it's referring to turning this client component props such as onclick into an actual form action so let's do just that first I would recommend that you try it out on your own and then we can do it together so if you want to give it a shot pause the video if not let's continue I'll turn this button into a form and I'll turn the onclick it's called a client side prop which is interesting onclick and I'll turn the

01:25:43 onclick which is specifically called a client component prop interesting name if you think about it into an action which is no longer a client component prop in the action I'll turn this into an asynchronous callback function and I'll Define you server here to the note that it's being used on the server then I'll say await sign out and I'll even pass an additional option of redirect to equal to forward slash so after log out we redirect back to homepage if I save this you can see we're now good you can see my full name

01:26:25 right here at top right and also the create and log out buttons this means that next o is properly reading the user session great for the time being I also have to turn this span into a button with a type equal to submit so now if we press log out we are out and if we press log in we're back in perfect I hope that made sense you have officially learned how to set up authentication from scratch using next off as well as some goas with using server actions within client component props and how to fix those issues within

01:27:02 new react 19 forms and I even prepared a quick diagram for you so we can do a quick recap as a user you first click that sign in with GitHub button at the top of course I'm referring to our login button once we click it our nextjs app will initiate authentication over to next off which will then redirect to GitHub oo GitHub oath will then request our user for authorization that looks something like this I click it and then if we haven't been logged in previously it would redirect us to that GitHub page but in

01:27:37 this case it redirected us and we directly granted permissions now it's time for GitHub and next o to communicate GitHub sent over the authorization code to next O next o exchanged that code for the access token GitHub returned that access token and then next o requested user data GitHub returned it and that was enough for us to create a session once the session was created we were redirected to the homepage and this is how the entire o flow works from scratch using next next o and a thirdparty oop provider in this

01:28:13 case GitHub but it's more or less the same for Google Facebook or any other if you'd like me to do more of these graphs and deeper explanations in future videos let me know in the comments down below and I'll make sure to include it every website also has its unique theme and if you compare the font family of our links you'll notice that it's different from the logo and it'll become even more apparent once we continue building at our homepage here we have a really bold font so let's ensure that

01:28:45 our entire app actually uses it for that we'll have to set up our tailan config so if you go to the description down below click the GitHub repo and then go to Snippets right here you'll see our Tailwind config and this time I'll make sure to explain it thoroughly so let's copy it let's go to our file explorer open up our tailwind config.txt and CSS works you extend the theme to provide some specific variables that you can use later on in the code so for example when you're saying EXs Max with something

01:29:25 then you're referring to 475 pixels to apply this property or with colors it's even simpler instead of every time saying text Dash and then providing a special property like this ff8 F0 and then closing it every time you can just simply say text- 100 basically you're providing your own custom colors which you can more easily reuse across the entire project and where are you going to get these colors from well if you go to the figma design and you show the UI you can select a specific element and then right

01:30:05 here under properties you can see the padding the width and everything and for elements that have a background or a font you can also see background colors so if you go right here to our hero section you can see E2 b69 and right here that is the default color of our application so what we're going to do is just take these colors and put them right here with proper naming different versions of blacks the primary secondary the white and then we're also adding a font family of font work SS I hope that

01:30:39 makes sense and if you'd like me to do a detailed video on setting up a Tailwind config just let me know with that in mind we get one more error in our application saying that we haven't installed Tailwind CSS animate it is a great plugin for Tailwind CSS allowing to further animate your Styles so in this case I'll simply run mpm install tailin CSS animate to add it to our pek adjacent alongside Tailwind CSS animate we also have Tailwind CSS typography which will allow us to further play with fonts so just run mpm install at tailin

01:31:12 CSS typography as well if you reload we're good to go now let's go over to our primary layout it is this one right here directly within the app we'll use this this one to set up the right fonts you could of course use Google fonts to set this up but it is actually preferable to have them hosted locally so I provided all the fonts and assets for this project right here within the assets directory so just open it up press download open up the assets and unzip them and then simply drag and drop them to the root of your directory in

01:31:47 the assets we currently have a new favicon so let's simply pull it into the app which is going to place the old one there we go this is the new one kind of like a light bulb idea for our startup next in the assets folder we also have the fonts so let's delete the current font folder and drag and drop the new one into the app and finally we have the public which is outside of the app this one right here below the node modules so delete it and drag and drop the one from the assets outside of the assets into

01:32:20 the root not into the app Remember the public folder has to be outside of the app now for the time being this will break our application because we have added new fonts so let's delete the existing ones and say const work sense which is the font family is equal to local font pass an options object with a source equal to and now we have to point to different font styles of that font here we're using the new nextjs functionality where we can define local fonts directly within our application each one will

01:32:54 have a path of that SL fonts slor sense dblack dttf so we're simply pointing to the path of that specific font this one is black so it'll have a weight of 900 and a style equal to normal now we'll have to duplicate this a few times so let's do that 1 2 3 4 5 6 7 maybe even because we'll want to have all different weights of that font so we'll have something like 800 which is going to be work sense-- extra bold then we're going to have 700 which is going to be bold then we'll have something like 600 which

01:33:40 is going to be semi bold then we have 500 which is going to be medium we have 400 which is regular then we have 200 which is thin and I'll duplicate it one final time this time it'll be extra light and it'll be 100 finally we need to provide a variable name right here below this array by saying variable to Define which class will set this font up it'll be font dwor sense great and you can see that it's still complaining here because we're using the previous Sans font instead of this right here we'll render

01:34:24 work sense. variable there we go and you can see our font family immediately changed for all elements within our Navar another thing we can do in this layout as you've learned at the start of this course is that you can change the title in this case let's call it YC directory and we can also provide some kind of a description like pitch vote and grow if I save this you can see that our favicon as well as the title have changed immediately that's great you've just set up the primary layout of our application to

01:35:02 allow for Tailwind CSS theming as well as you have learned how to use local fonts allowing you not to depend on external services like Google fonts you have added your own fonts within your application which will always be here no matter what great job now we can move to an exciting part that will turn this black screen into something much more engaging so let's focus on the hero section next to get started with our homepage you can go into the root route group and dive into the page. DSX this is where

01:35:39 our home is now remember when we were talking about theming not that long ago well in this case we'll extend our theming even further if you take a look at the design you'll notice that there are some shared styles that we can read use such as the heading right here you can notice that this picture startup connect with entrepreneurs is also shared here and here same thing for this yellow thing at the top the styles for this description so instead of declaring the Styles every single time we can

01:36:12 create a utility class called heading or subheading and then we can reuse it further let me show you how to do that I'll head over to global. CSS and here we import in Tailwind which is great but what Tailwind CSS also allows you to do is to add something known as ADD layer and then utilities these are called utility classes and if you say something like do heading right here you can use a property of apply meaning once you use this class which tailin CSS classes will be applied well let's think about it for

01:36:50 example you'll apply a property of uppercase right here because all of the text is uppercased so let's do uppercase Also let's do BG black because it'll have a black background padding X of six to provide some spacing on the left and right and padding y of three to provide spacing on top and bottom usually it was easier to get these styles from the figma design but nowadays figma wants you to pay for the dev mode if you had it you would be able to extract some more additional CSS properties from it but don't think that

01:37:21 you would immediately get everything and then paste it here um typically many things in the design are hardcoded like for example this padding values you're not going to put these exact values because we have to ensure it works across all devices so it's good to sometimes try to figure it out on your own and then convert those styles from figma to here we'll change the font to font work sense we'll change the font to extra bold we'll make the text white because we have a dark background here let's also set on small

01:37:54 devices the text size to 54 pixels on small devices we can also set the leading which is the space in between the characters to 64 pixels typically the text can be set to 36 pixels oh it's jumping out of my screen right here because it's so long there we go the text will be set to 36 pixels typically the leading will be set to 46 pixels if we're on regular devices Max W will be set to 5 XL text will be centered and margin y will be set to five that's a lot of classes for one single heading but it's much

01:38:32 better to have them here in the utilities rather than to have all of those things copied and then we can paste them right here for this heading I mean just look at this right it will be too much and if it go back sure we have a nice looking heading but even the fact that here we have all the Styles is not a problem that's how Tailwind CSS is designed what is a problem is that back right here on our create we'll have to copy and paste all of those Styles and then imagine if one thing changes not

01:39:07 good right same thing here so for that reason we create a utility class give it a name and now when you want to reuse that same thing you just say heading okay so now if we go back before it works we actually have to import the font right here in the global and we do get a slight error here but it just looks like I forgot it to add a dash right here in the font Works hands so if I add it we're good you can see the home right here and our code right here is looking incredibly clean now you can head to the read me file of this video

01:39:43 and copy the global. CSS from there and override everything we have here if you do that you'll notice that we're adding a few more of these utility classes to make the styling of our app a bit easier but at any point in time you can just refer to the global. CSS and see exactly what CSS are we applying as you can see the heading we just wrote is right here among the tag the pin container the subheading and more I hope this makes sense now alongside improving our theming with the global. CSS to make our Tailwind CSS

01:40:16 classes more reusable it's also the perfect time to install shaten to be able to reuse some of the components that will help us make the UI of our application so go to ui. shen.com and search for the CLI they just released it it is completely new and it's something I want to teach you in this course as well the Shian CLI provides an init command allowing you to configure and add dependencies for your project so let's do it together we can copy this command and add it to our terminal MPX Shad CN add latest in

01:40:54 it it's going to ask us a couple of questions you can choose the style of New York in this case let's go with slate and for CSS variables you can choose either yes or no and this will update our tailin config and our Global CSS so let's check them out by going to globals looking at the globals it remains very similar but they have modified the one that we have copied so it's better to stay on the safe side and copy and paste it one more time from the read me that I provided to you and the same things goes for the Tailwind config

01:41:27 because they modify that as well so if you just override both of these two new files and go back to Local Host 3000 everything should look great and we are ready to start coding the header of our application first I'll create a new section it's an HTML 5 Section component and I'll give it a class name equal to pinkcore container and this will provide this container right here and within it I'll put this H1 with a property of heading instead of simply saying home it can say something like pitch your startup then we can add

01:42:09 a Break Tag and right below we can say connect with entrepreneurs okay this is looking great and below this H1 we can also create a P tag that will have a class name equal to subheading and exclamation mark Max dw-3 XL we use exclamation mark when we want to override some other styles previously provided to this element and here we can say submit ideas vote on pitches and get noticed in Virtual competitions there we go sounds exciting if you make your screen a bit smaller like this or if you make it even

01:42:59 larger you'll notice those lines appear right here and those lines form a very important part of our visual design so where are they coming from well we can further inspect the pink container class which is right in the globals and here we apply a pattern class name to it let's explore that pattern further it is right here below and you can see that we're applying a background image where it's just a single line being repeated now we can collapse it even further let's go somewhere on the mobile view

01:43:33 right here and this is already looking great and what do we have to do below our P tag well let's refer to the design it'll be the input field and while we could create it right here it's better to create a new component for it because while the homepage is server side rendered the search input will have to have some client functionality right to manage keyboard presses and button clicks at least that's what we expected so far right so let's see if that's still true with the latest versions of react and nextjs is there maybe a way to

01:44:07 allow us to keep this component as a server rendered component well let's give that a shot in the next chapter let's create a new component in the components folder which I'll call search form. TSX run rafc right inside of it to create a simple functional component and then import it right here below the speed tag that's going to look something like this search form there we go my IDE Auto imported for me coming from at slapp SL components SL search form and right here in the hero section you can see the

01:44:49 search form appear right here which means we are ready to dive into it and start implementing it but let's get to the elephant in the room if this is going to be a form and it surely will can we still ensure that this is rendered on the server side and not client side up to this point that would have been impossible but with react 19 forms and the way that nextjs is extending them even further the new form element now provides prefetching and UI loading client side navigation on submission and Progressive enhancements

01:45:22 in simple terms nextjs now supports a new form component which is used to automatically update URL search parameters and reduce the boilerplate code needed to achieve anything the basic usage looks something like this so let's implement it together first I'll wrap everything in a form coming from nextjs that form will have an action equal to forward slash and it also has a scroll property which we can set to false we don't want to scroll anywhere once we sub submitted and we can also give it a class name equal to search

01:45:57 form there we go quite a simple form right within it we will render just a regular HTML input with a name equal to query the default value equal to an empty string for now a class name equal to search- input and a placeholder equal to search startups there we go that looks great finally if the user has sted something into it then we can provide a button to reset the form so let's create a div with a class name equal to flex and the gap of two and now we'll want to implement this button right here but

01:46:37 before the button if we type something and search for it we want to also implement this x right here so we can clear our search so later on we'll have some kind of a query right here so let's define a fake query and let's say that it's equal to something like test we can use this query as a default query here as well that's going to look something like this and now if we have an active query then we want to render some kind of a button that would allow us to reset it so for now this can be a regular

01:47:09 button of a type equal to reset and on click it'll call the reset function so we can declare it right here above const reset set is equal to a functional component where we first have to get access to the form by saying form is equal to document. query selector we're going to search it by a DOT search- form and since we're in typescript we have to define the type as HTML form element like this and if a form exists then we're going to Simply run form. reset which will reset the form on that button click but here's an

01:47:53 issue even though the form itself will be a server side component the button and the onclick recalling here is still client side so we have to extract it into a new component that's going to be pretty simple we can create a new component called search form reset. TSX run rafc within it then we can take this button and and place it right here and we can also take this reset form and we can place it right here within this component now going back instead of this button we can simply render the component that we just

01:48:42 created search form reset as a self closing component and now if we go into that component for the first time in this video we can use use client directive to turn only this small part of the UI into a client component but the rest will still be serers side rendered this button will render a link right within it coming from next link it'll have an HRA of forward slash and a class name equal to search- BTN and within it we can just render an X character we can also give it a text- white so we can see that X

01:49:24 there we go this is looking good now right below it we'll render another button and this one will have a type is equal to submit to submit the form with a class name of search- BTN and it can say something like s for search of course later on we'll turn this into an actual icon but for now we can give it s and then text- white so we can know that we can clear the search as well as actually search for something so how does this work right now we're not really submitting anything or clearing anything because the query is always set

01:50:01 to test but let me show you how easy it is to now make this into a fully functional URL modifying server rendered form for a moment we'll go back to this page and there we'll try to access the query from the search parameters so you know how I taught you that right here through prop on every single nextjs page you have access to search prams we have to define the type of search prams as well so we can say search params will be equal of a type promise which then results in a query which is going to be of a type string then we can

01:50:42 extract that query by saying const query is equal to we can wrap it in parenthesis say await search for rams. query and if we provide await there we have to turn this function into a sync and now that we have the query we can simply pass it into the search form as a prop so let's say query is equal to query back in the search form we can now accept this query as a prop query and it'll be query optional of a type string and now we can remove this fake query reload our application clear this test and you can see that now if we

01:51:21 search for something like let's say startup for robots have you seen Elon musk's latest wi robot event that was pretty crazy so let's search for we robot and press enter check this out it worked immediately even though you might not know that it's doing something but it's actually modifying the query in the URL saying we robot it's automatically doing all the pars sync such as adding a Plus instead of a space and it is as easy as that I can now actually clear it which clears it from the URL and it

01:51:54 works perfectly you can continue modifying it and it's just Flawless it's super simple yet super effective because it is a robust serers side rendered form which just works it's connected through nextjs search prrams query and yeah that's it to be honest I'm pretty amazed at how simple it is to implement forms typically it is much more complicated now to finish it off let's actually add icons here instead of an S we can use a search icon coming from shaten or if I'm going to be more precise it's coming from Lucid react

01:52:35 which is a dependency of shat xen which provides all sorts of great icons so we can give it a class name equal to size of five there we go that's much better and we can do the same thing within the search form right here where we can turn this into an X icon with a class name which is equal to size all five and there we go this is now looking great while we're on the topic of shaten we installed it but we haven't really used it up to this point so let's say that we want to turn these buttons into shat CN

01:53:11 buttons how would we do that well head over to the terminal and run MPX shaten add latest add and then you typee the name of the component you want to add such as is a button the code for that button will automatically be installed and added to your codebase that's the benefit of using Shaden over some other component libraries like material UI because they actually provide you with the full code for this button and it's completely yours you own it and you can change any properties even though in

01:53:43 most cases it's not necessary because you can style it further by simply providing additional tailin CSS classes now the chat CN created this new components folder I I notice that we have our own right here in the app and that's actually not a recommended practice so I'm really glad that this has happened typically in nextjs I would recommend keeping within the app only the things that nygs specifically needs there such as the routes or API folders or fonts or favicons or layouts but components are additional pieces of UI

01:54:14 that you can put outside of it so for now let's simply take these three components and move them over to the components folder that is outside of the app folder and let's delete this components folder now the shaten components will be within the UI and our own components will be just within the components folder and we might need to modify some paths to make this work so let's head over to root and then layout. TSX and let's fix the import for this snap bar by removing the app folder and same thing in the page remove the app folder

01:54:53 from the import and one more time in the search form remove the app from search form reset and we are good great in this chapter you learned how you can use the latest and greatest of react and NEX gs's new form to handle it all on the server side with less Boiler blate code in the next chapter let's focus on what comes after the hero section which is a list of all the startups of course to create all we only only need to create one proper reusable startup card and the rest will simply follow so let's do that

01:55:30 next right below the Ping container or the hero section I'll create another section which will wrap all of our startups or startup cards I'll give it a class name equal to section uncore container and there I'll render a new P tag with a class name equal to text D30 D semi Bold And if a query exists then I'll render something like search results for and let's make this a template string so we can modify it query pretty simple right search results for the following query but if a query doesn't exist we'll simply say something

01:56:11 along the lines of all startups great let's save it and you can see all startups but if I search for some something like programming keyboards you can see search results for programming keyboards pretty straightforward right now let's go down and let's create a UL an unordered list with a class name equal to margin top of seven and cardor grid now this cardor grid is a very interesting utility class so let's explore it further I typically select it and then press command shift F which opens up the global search in this IDE

01:56:57 and then you can just automatically find it within the globals or you can just copy it go to Global CSS and search for card grid perfect now this card grid right here applies a three column grid on medium devices and a two column grid on regular devices basically for devices of about 768 pixels or about 800 pixels and larger it'll show three columns and for smaller devices it'll show two and then a gap of five applies about 20 pixels of space in between the elements now within there we can map over our

01:57:35 posts later on of course we'll fetch those posts directly from sanity but for the time being I can create a new array const posts which is equal to an array where we have some objects and let's say that each object contains an underscore created at property here we can say something like yesterday it can also contain the number of views that the post has so let's do something like 55 we'll need to have an author of the post and that author will be an object because it will contain more information

01:58:08 such as the ID of the author and that can be an underscore ID we also need the underscore ID of the post itself so we can set that to something like one as well of course what would a post be without a description so we can say this this is a description and we can also render an image so for the time being we need to find a live URL of an image oops it looks like while I was searching for that live image the recording actually stopped so you can find any image online put the link here and then after that

01:58:40 add the category in this case I typed robots and then also add the title I said we robots right here once you do that you can head over to the UL that you created before and we'll need to map over the posts by saying posts question mark. length is greater than zero and if it is greater then we can map over the posts where we get each post of a type startup card type and an index and for each one we can render a new component called startup card so now let's create this startup card component by going to

01:59:14 the components folder and creating a new file called startup card. TSX you know the run rafc and then go ahead here and just import it automatically and this will fix the issue you should be able to see one startup card appear because we only have one Post in our fake posts array to this startup card we can pass the key because we're mapping over things such as index but typically passing an index as a key is not the best practice so what I would recommend is just getting the post and then underscore ID as the

01:59:49 ID because that's going to be always unique and we can pass the entire post itself great now we have to go into the startup card to accept those props and to render them nicely on the screen so let's get access to the post and that is of a type post is a startup type card we'll add this one later on once we Implement sanity because one of San's great features is automatic type checking for the documents in our collections for now this should shouldn't break our application so let's turn this div into an Li because we are

02:00:26 now within an unordered list and each Li will have a class name equal to Startup dasc card and group there we go that'll immediately provide some nice borders within it we can create a div with a class name is equal to flex between within it we can render a P tag that'll have a class name equal to Startup undor cardor date and within there we can render the post. created at property or underscore created at is how we defined it and now we can see that it was created yesterday what do you say that we immediately turn

02:01:06 this into a real date property for now we're just passing yesterday but what if we used a new date like this which will actually generate a date JavaScript object which is how we want to do it if you pass a new date we won't be able to render it just like string we'll have to somehow turn it into a meaningful date string so let's head over to the utils file this is typically where you want to add functions that do those sorts of things so let's say export function format date which accepts a date of a type string and then

02:01:43 it returns a new date of that date that we pass in but we call do to Locale date string in the loc of enus and we can pass the month as the option to be set to long a day to be numeric and a year to be numeric as well now if we save that we can wrap this post that created ad into format date coming from lib utils and just pass it in if you do that now we can see October 133 2024 looking great right below this B tag we can create a div with a class name equal to flex and a gap of 1.5 within it we can create an i icon

02:02:36 which will tell us how many views we have so let's give it a class name equal to size of six and text- primary and below it let's render a span that'll render post. views if I save it we can see 50 5 use we can also give this pan a class name equal to text- 16- medium going to divs down let's create the second part of the card by giving it a class name equal to flex Dash between margin top of five and the gap of five within it we can have another div with a class name of flex D1 and within it we can have a link

02:03:19 element coming from next link this link element will just wrap the author's name so we can point its href to SL user SL post. author questionmark doore ID and within it we can render a ptag with a class name equal to text 16 medium and line- cl-1 which will ensure that this username stays on one line and within it we can render the post. author question mark. name if I save this we should be able to see something here but there's nothing appearing so if I go here oh I forgot to pass a name to our

02:04:02 imaginary author let me use Adrien in this case there we go I forgot what kind of startup is it oh it's about Elon musk's new humanoid robots Okay looks like I'll be working with him on that now you can see that we're often repeating post. views post. author post. author that something well it'll be easier to just destructure the properties coming out of that post you can do that right here const D structure is equal to post and then you can think things out of it such asore created at or views or

02:04:38 author and then from the author you can further take out the ID and the name what else do we have we have a post title we have a category the post ID the post image you get the idea right we can later on destructure some additional properties if needed oh here's an interesting gotcha with destructuring if you're destructuring a subproperty from another property and in the same line you're destructuring another property with the same name you need to rename one of those so let's actually rename the author ID the

02:05:11 underscore ID belonging to the author to author ID like this there we go and now instead of saying post. created ad you can just say underscore created ad views here you can just say author ID and right here you can also say name much simpler right same code but makes more sense below this link we'll use another link and this one will have a bit of a different href this href will point to SL startup slost doore ID or just uncore ID and here we can render an H3 with a class name equal to text- 26-

02:05:59 semibold and line- clamp D1 and it'll actually render just the title right here great oh make sure to properly close the link there we go we are good and you can already notice that we're using two links one next to another and we'll use many more links going forward so why are we using different links for the same card well that's because each one of these these links will lead to another place if you click the person's name well that goes to the profile page if you click on the title that goes right here to the

02:06:32 startup Details page click on the image project details click on the user Avatar well that's going to go to the profile details you get the idea right and since we cannot have children link elements meaning one below another such as if we had the entire card wrapped as a link pointing to project details and then have these children elements pointing to the profile I decided to create more adjacent links pointing to different routes in our application now let's go below this link and below the div and

02:07:01 let's create another link this one will point to the user once again so let me copy the atref from the user within it will'll show the Avatar image so let's render a nextjs image tag with a source of https Colin SL placehold doco SL600 by 400 and we'll give it an ALT tag of placeholder with a width of about 48 height of about 48 and since this is the Avatar image I'll also give it a class name equal to rounded - full now if you close it and go back you'll see that nextjs will prevent us from rendering this image because it

02:07:51 doesn't know whether we trust this placehold doco Source but we do we just have to let it know within the next config so let's head over to N.C config.txt TPS and a host name in this case we'll leave it to as asterisk to allow for images from all sources there we go now if you reload you should be able to see a placeholder right here but it doesn't seem to be appearing and if you open up the terminal you can see why the requested resource has type of SVG XML but dangerously allow SVG is disabled so

02:08:36 what you can do is copy this dangerously allow SVG head over to next config go within images and then add dangerously allow SVG set to true and then if you reload you should be able to see the image appear right here I think even setting it to 4848 would make more sense in this case there we go perfect now later on we will remove this dangerously allow SVG we're only adding it right now for our placeholder images but keep in mind later on these will be coming from different sources and they won't be in

02:09:09 SVG but it's good to know that nextjs is actually protecting us from things like this now let's go below this link and below the div and let's create another link this will be the container for startup details so let's copy the href pointing to the startup details and within it let's create a new P tag with a class name equal to Startup dasc cardor description or DC for short and we can just render the description in there make sure that we have these structured it right here at the top looks like we

02:09:46 haven't there we go so now we have this is a description right below this P tag we can add an image and sure you could use the next gs's image component but in this case I want to tell you that you don't have to nextjs is very generous with its free plan but if you have a lot of images you can use up some of those optimization calls but you don't have to if you just use a regular HTML image pass it some kind of a source like image an Al tag of placeholder and a class name of startup dasc card under \_ IMG

02:10:23 you can show a nice looking image right here as well without spending additional optimizations for now I'll leave it like this now let's go below this link and let's create the footer of the card by creating a div with a class name equal to flex Dash between gap of three and a margin top of five within it we can create a link this link will have an href equal to a dynamic template string of SL question mark query so it'll actually update the query based on the category of our post and we have to set it to lower case

02:11:03 within the P tag we can simply say class name of text 16 medium and we can render our category below this link we can render a Shad CN button with a class name equal to Startup up- cardor BTN as child because we have a link within it so we want to take the form of a link and here we'll point to the startup details one more time so we can say for SL startup slore ID and we can say details right here there we go so now we have a nice looking card with the info about the user pointing to user page and

02:11:51 additional info about the startup pointing to the startup Details page great job so far this is looking amazing and if I go full screen it is looking even better you have implemented the navigation bar that allows you to log in or log out we have a search which is technically working because it actually modifies the URL query based on what you type and finally you have developed a card UI which will'll reuse for all of our startups but right now with one limitation which is that we have fake data for it right

02:12:27 now we have no way to add new startups to our application so that's exactly what we'll do next I'll teach you how to use and Implement sanity let me tell you a bit about why we'll be using sanity for this video sanity is not just a CMS the one that you hand over to your clients and let them manage data in sanity's case you can truly leverage their apis to build a whole operating system around the content you'll have the studio that will mirror the content workspace of your application that you can hand over to

02:13:01 your clients so they can manage it as well and that studio is built on top of powerful apis that allow you to completely customize the way that you create and manage content and finally they actually store it for you don't think of this as some kind of low code no code tool it's far more than that some of the biggest companies in the worlds such as Puma Tata digital or even morning Brew use them for managing their content you can also use them for many different use cases such as marketing media e-commerce and more it's built for

02:13:33 Enterprise so many Fortune 500 companies use it so if you're saying something like oh but our companies actually using sanity the answer is yes and you can be the one that's going to implement them within their team to make them recognize the power and speed and efficiency that allows them to manage their content in and the best thing they're very neatly integrated with NEX GS everything works seamlessly everything from development to deployment to verell so merge changes instantly go live on the global Edge

02:14:05 Network there's the SSL encryption asset compression cash in validation a lot of things that together sanity and versel do very well and then the thing that we just have to discuss the pricing sanity's pricing is incredibly generous if you're just experimenting or even if want to ship smaller projects it is completely free forever you can even add 20 users two data sets and you also get all other features such as unlimited content types locals hosted real-time content database and more those are the

02:14:36 reasons why I chose to use sanity for this project now you can click the special link down in the description to be able to follow along and see exactly what I'm seeing once you do that click Start building and create an account enter your project name you you can make it start with something like JSM and then YC directory or in your case it can be JSM and then you can enter some other name of the project we'll start from scratch with the CLI so click create project and there we go now we can initialize our project with the

02:15:09 CLI so let's copy this command go back to the code and paste it right here it'll ask you whether you want to install create sanity the CLI so just say yes and it's going to ask you to log in so you can choose the login type that you used initially I'll go with Google and you'll be authenticated once that is done you'll be asked whether you want to add configuration files for the sanity project in the nextjs folder press y yes do you want to use typescript that's going to be a big yes as well do you want to use embedded

02:15:44 sanity Studio that's going to be a yes what route do you want to be studio in by default it's for/ Studio so that's okay with us in this case we'll go with a clean project no template we'll do everything from scratch and would you like to add the project ID and data set to your env. loal let's say yes and there we go our dependencies are getting installed and soon enough we'll be able to explore sanity studio in more detail there we go sanity configuration files have been added successfully and next

02:16:15 we'll have to install the latest version of Sanity to use the live API feature they offer so I'll type mpm install next sanity at Canary and press enter now let's explore the files that have been created for us if you head over right here you'll see sanity C.S it automatically added environment variables for us and we also have our config pointing to the base path of the studio so we should be able to explore this route let's give it a shot back in the browser I'll head over to Local Host 3000 SL

02:16:48 studio and press enter but if you visit this page it'll probably cause an issue and show this error could not parse module this happens because sanity Studio doesn't work with turbo yet so let's head over to the package.json and under scripts where we have a Dev script we'll remove the-- turbo for now now if you stop your application from running and rerun it by running mpm runev if you go back and reload you can now sign into sanity studio with the same email and password that you used initially and

02:17:20 here we are we're successfully authenticated you'll be able to visit the studio but you won't be able to see anything there as we chose a clean Project without any schemas when setting up the project so before we can start adding some content right here which is going to be super easy and intuitive we can go back to the code and explore the new files that have been created for us let's start with sanity C.S this is a config file so we can use sanity operations via the sanity C CLI such as the project ID data set and more

02:17:55 below that we have a sanity config this is a simple configuration file used for sanity Studio where we set the base path and connect it to a specific project ID data set schema and add specific plugins next we have some more important files and those are going to be within the sanity folder specifically we're going to look into the sanity lib and then client. TS this is the sanity read client for fetching data through queries if you set the use CDN part to false this will make sure to cache whatever

02:18:28 content you request for 60 seconds after 60 seconds you'll get a newer version of the data but in between the content will be delivered from the sanity CDN network if you remember this is the ISR data fetching strategy next we have a lib image. DS and this is simply an image URL builder for images uploaded on sanity studio so we can use on the front and side we won't need it as we'll use a markdown plugin instead so we can remove it from here next we have sanity schema types right now with empty types later on

02:19:03 we'll create our own sanity schemas and Export them so that our entire application knows what kind of fields will each startup or each document will have we have our envs where we list which kind of envs we need for our application and finally there's the structure where you can decide how do you arrange your schemas do you want to group them add specific schemas on top or others at the bottom you do it here and finally you're asking how does the sanity Studio get surrendered within our app well they have added a studio page

02:19:35 right here where they show their Studio as simple as that so in this chapter we have successfully set up sanity I also told you a bit about why I think it's super useful and the reasons why we're using it and we also went through all the files that it autogenerated for us to make the setup easier now in the next chapter we'll focus on creating your own sanity schemas so we can structure the types of the documents in our database let's do that next now that you know everything about sanity how to set it up and which files

02:20:07 it generates let's use it to create our own database structure whenever you're starting to work on any backend or any kind of database structure specifically first think about what do you need in our example we need to store startups submitted by a user of course that includes the user information that submitted those startups in the first place and then we need to group those startups into some kind of playlists so we can show them as editor pics or startup of the month day honors and so on so in simple words this is how a

02:20:42 database structure will look like we'll have a startup and each startup will have a title a slug which is kind of a unique name or ident identifier for that startup the author that created it so let's quickly talk about that the author will be authenticated through GitHub so we'll automatically get its ID name username email image and bio each startup also has to have views descriptions category image and then the pitch itself which is going to be in markdown format and once we have the actual startup then we can have

02:21:16 different playlists in which we can categorize those startups and then retri them I'll either put the link to this entire flow somewhere in the GitHub readme of this project or images pointing to these different documents either way creating these additional documents that would further explain the application to you is something new that I'm trying out so if you like that please let me know down in the comments but with that said let's explore this second graph that in even more detail explains how the app will work this is

02:21:46 our app which will then hook up to next a to authenticate our users and create a session if a session does not exist we'll head over to GitHub ooth authenticate the user get the user information and then create the session for that user if a user exists then we'll make a call to sanity to find that user as an author if that user is not an author yet if they don't exist we'll create a new author but if the author exists then we'll return that author and then they'll be able to create different startups I hope this makes sense so

02:22:21 let's get started by doing exactly that let's create a schema for our author I'll head back over to Sandy schema types and I'll create a new file right here which is going to be called author. TS pretty straight forward right you will Define the author here as you would in let's say you say export const author is equal to Define type and this is coming from sanity and then you pass in an object with a schema definition where you can pass the name equal to author you can pass the title which is going to be the

02:22:59 capitalized version of that then you can pass the type of this which will be a document finally you can use an icon for this document which is going to be a user icon and we'll import this from sanity icons and then you define the fields that each author will have which is going to be an array of fields where each field will be a defin field call inside of which you pass a schema field definition such as name of the field is going to be an ID and then the type of the ID will be number and we can

02:23:34 now duplicate this a few times to create all of the other necessary Fields so let me do just that 1 2 3 4 5 I think that should be enough the second field will be name each author has to have a name of a type string then we'll have a username as as well which will'll pick from GitHub that'll be of a type string we also need an email of a type string we're going to have an image which is going to be their Avatar image of a type URL and finally we'll have their bio which is going to be of a type text we

02:24:07 get all of this from GitHub ooth finally we can go outside of this array of fields and say preview Select Title name so this allow us to select those authors by name and preview them great believe it or not this is our author type we're already exporting it so the only thing we have to do now is to use it we can first use it within the index DS within the schema types and here we can use it by simply saying author within this array and then importing it from the schema types author next we need to structure this

02:24:45 schema in structure. DS so let's head over to structure. DS and here we can list different things that sanity provides so as that list we list them by content and then we can Define the items here instead of just having one items and then a single s document type list item I'll copy this part right here and open up an array of items where the first one will be a document type list items of a name author with a title of authors and it looks like have an extra s right here it's list item and there we go now we're good

02:25:24 while we're added why don't we go ahead and create a startup schema as well you now already know how to do that you can go to schema types and create a new type startup. TS to quickly get us going we can copy everything over from the author paste it in the startup in this case we won't be needing the icon so we can delete it and we can modify the name of this type such as startup capital S for startup in the title also of a type document and now we can Define all the fields in this case we don't need the ID because we'll have

02:25:58 the slug so let's say slug type Slug and check this out we can provide options and say source of this slug will come from title so it will actually be autogenerated for us by sanity based on the title for example if a title is this is a great post or a great startup it'll simply generate something like this is a great startup or if necessary it'll also provide some additional unique identifier info to make sure that it's not the same as any other slug or title next we can have a title which is going to be of a type string and let's

02:26:37 actually put the title above right here next instead of the username we can have the author and this author will actually be of a type reference and then we have to give it an additional property of two so reference to what and it'll be a reference to a type of author next we can Define the number of views that each startup has and it'll be of a type number we can define a description for each startup which will be of a type text next we'll have to define the category of each startup it'll be of a

02:27:11 type string for now there's definitely a more fitting type for this category such as an enam or just providing couple of options that they can pre-select from but in this case I'll just keep it a regular open string for the sake of Simplicity and I'll also show you how to add additional validation on it you can open up a new Arrow function here get the rule through params and then Define the rule by saying rule. Min it's going to be minimum one it's going to be Max 20 characters it's going to be required

02:27:43 and if we don't pass it we'll say something like please enter a category let's also create two additional feed so I'll copy this description one and paste it below this one will have a name of image and type of URL of course you could use sanity to store images here in this case I just opted for pasting the URL of an already uploaded image just for the sake of Simplicity but after this video is done this is definitely one of the many optimizations that you can make and we can also add a validation for this one by defining a

02:28:16 rule and saying that this image is required finally we can duplicate theine type one more time and we can call this pitch which will be of a type markdown great our second schema is done we can just change the variable name to Startup and then go back to index.ts and add it right here next to author we can also go to the structure we can create a second part of this array I'll actually make sure to duplicate it here and instead of authors this time we can say startup and startups now let's go back to the

02:28:53 startup for a second and in this case we won't need this preview by name so we can remove that and keep in mind that the last field is of a type markdown markdown field is a custom field which uses the official markdown plugin by sanity so let's go ahead and install it by running mpm install sanity Das plugin Das markdown this is also a pretty good lesson so I can show you how we can add additional plugins and once it gets installed you'll have to go to sanity doc config.sys array also for this to work we have to

02:29:52 go back to one of the first files we worked on and that is app layout. TSX where we have to add all of the general configuration in this case the marked and plug-in also requires additional CSS so right here we can say import easy mde slist SL md. min. CSS this will make sure that our editor looks great now if you go back to your sanity Studio which is just localhost 3000 for/ Studio you should no longer see an empty slate rather we should be able to create a few startups directly from the dashboard let's first

02:30:34 create one mock author by creating a new author document for now we're still mocking all of this data but very soon we'll connect two santies database from our application using their API for now I'll say one the name can be Adrian username can be something like JS Mastery any email we'll do right now so let's say contact JS mastery. proo I'll head over to Google and just copy the image address of the JavaScript Mastery logo you can take out any other image address based it here and for the bio

02:31:11 I'll say nextjs Enthusiast and I'll publish the author great you can now see one author in the author's array let's also go to startups and let's create a new startup I'll actually go to the finished version of the application which you can find linked below and then I'll copy some of the properties light here such as the title we can also get the description right here the slug can be autogenerated based on the title pretty cool check this out author is the reference to all existing authors so I

02:31:42 can set it to Adrien the number of views can be set to one or zero by default we have to add a category in this case the C category can be set to something like education and we have to add the image so I will simply copy the image address that I already have here and finally you can write the entire pitch details using markdown so I can say something like this is great all of you should vote for my startup and of course you get all the benefit of including code blocks images and more right here through the typical

02:32:17 markdown editor that you're used to you can also see the Finish version right here great with that said I'll go ahead and click publish it was published I got to say everything is behaving super smoothly right here and now that we have one author and one startup the question is how can we now see them within our application so in the next chapter I'll teach you how we can go from having this one fake card to fetching the real card generated by a user from sanity studio and then later on in the course we'll of

02:32:47 course create our own create page so that our users can create new startups without necessarily going to sanity Studio rather they're going to be able to do it straight from the app great now let's learn how we can fetch real data from the database in order to fetch data from sanity we'll have to use something known as Gro queries Gro is sanity's open source querying language which is powerful and intuitive so it's easy enough to learn you can describe exactly what information your a needs join

02:33:21 information from different sets of documents stitch them together and basically do whatever you want you can go through a tutorial reading about how it works but I'll teach you all of that in this video and even better than learning we can visualize and see exactly how this works in real time so let's head over to for/ studio and then open the vision tab here you can write the query and the params and see the results in real time check this out as the query I'll just enter an Ask risk meaning give me everything related to

02:33:51 sanity project from members to Grants startups authors everything here you can see that the first property is our user JS Mastery nextjs Enthusiast then if we go a bit down we should be able to see our post as well now if you do something like asterisk and then zero inside of square brackets you can just get the first property pretty straightforward right but what if you want to get all startups well you would say give me everything where the underscore type property is equal to Startup it's very similar to

02:34:26 just writing PL all JavaScript and there we go we get one property where we have all the information about that startup what's pretty cool is that it doesn't return the author information rather it provides a reference to the author document but now how would we get only the information that we need we don't necessarily need the updated ad property the Rev and so on so how can we be a bit more specific about what do we return from a document well we can say give me everything where type is equal to

02:34:57 Startup and we can say defined slug doc current which means it's not null this will go within the square bracket so we can just clean it here and put it right here at the end I'll expand this a bit and then we can open up a new curly brace and within it say exactly what we want to get back such as the ID title slot undor created at we can also get the author let's also get views maybe the description the category and the image and let's run fetch there we go so now we get back only the information that we

02:35:37 actually need but how do we also get additional information about the author of that post in this same query well take a look at this I'll first space this all out so it's easier to see there we go and now you can add an arrow pointing from the author and then you can open up a new pair of curly braces there you can Define what do you want to get from the author such as the ID name slug image and bio if I now run the fetch you'll see that the author will no longer be just a reference rather we'll

02:36:10 get all of the information about it I don't think we have a slug for the author so we can just leave it like this great now of course we won't be making calls that directly from sanity Vision right here rather I want to copy this query go back to our code specifically to sanity lib and create a new file called queries. TS here we can say export const startups query is equal to you can say Define query which is coming from next sanity and then as a template string you can pass the query right in and this

02:36:48 will be the same as what we just wrote In The Vision part of Sanity Studio One part that also would be good to add here is after this square bracket we can do some sorting by providing a straight line and then saying order is equal toore created at and we'll set it as descending which means that the newest one will appear on top that's going to look something like this now how can we actually fetch this well let's go back to our home so that's going to be page. TS in the root this one right here check

02:37:23 how we currently have this fake post right here well let's make it real I'll create a new variable const posts is equal to await client coming from sanity client so you have to import it right here at the top do Fetch and we're going to fetch what the startup squ this one right here which we can import from queries now I will comment out the current posts and before we go ahead and check them out on the homepage let's first add a conso log that's going to be json. stringify posts and to style our output of the

02:38:04 console log a bit better we can say null and two this will just create some additional spacing so now if you go to the terminal and open up a new Local Host window you'll see that we get an array of all the posts currently being just a single post with all the information that we have about it and if you go back to Local Host 3000 check this out the card with the real data just appeared and we can see it right here isn't that great that's pretty simple right if you want to hand this app over to your clients that can use

02:38:34 sanity Studio to add new posts in a nice looking UI well you're good to go you can call it a day but soon enough we'll also Implement our own create page so that other users can create additional startups directly from YC directory now now we can remove this fake Post in the conso log because we have the new posts coming directly from sanity into our app but remember that we don't yet have a startup card type it's going to be necessary for our startup card because we're using typescript we need to be

02:39:05 able to know exactly which properties does each startup have and typically that's tedious work because you have to know the type of each one of these things you have to be precise in defining it you have to know whether it's optional or not but instead of defining types manually sanity's new tool generates types automatically it generates types both for sanity Studio schema types and grock querying results to leverage that tool we need to add sanity type gen there's a great documentation page with a video from

02:39:38 sanity that teaches you how to generate tab script types you can go through it but in this case you also have me so I'll explain it to you right here and right now first things first is we have to extract the schemas we have already created you know I'm talking about this ones here startup and author to extract those schemas we need to run an additional command so let me expand this and let's run MPX sanity add latest schema extract D- path equal do/ sanity extract. Json and press enter as you can see it's extracting schema

02:40:20 and they have extracted it to extract. Json next we have to create a new file in the root of our application called sanity dtype gen. Json and in here we can add one configuration object I'll actually copy this object over from sanity learn and I'll make sure to include this in the read me so you can copy this part as well this configuration will scan the application for all Gro queries to create types additionally it'll also use the extract. Json from the previous command we ran and it'll write a new types. TS file

02:40:54 with our other utilities and this generates command will create a new types. TS file I just noticed that in here they were using the source folder which we're not using so we can remove that Source maybe it's already removed for you if it's not just remove it and then run the command MPX sanity ad latest type gen generate and press enter this just generated the typescript types for 14 schema types and zero grw queries for now but later on as we add additional queries and schemas we'll have to rerun this Command right well

02:41:29 unless we automate it within our packet Json so let's head over to Packa Json go under scripts and add a few new scripts we can get those scripts right here from the learn but as I said I'll also provide this over to you in the read me down below and paste those scripts once again I'll also remove the SRC from here as we're not using that folder so it be just do/ sanity now you can just run mpm run type gen so whenever we need to get new types you can just run this command and be good to go finally let's define

02:42:02 the type for the startup card to do that we can go to our startup card and create a new type we can also export it export type startup type card which is equal to we can use the omit property here for typescript which constructs a type without the properties of T which is the first parameter we pass except for those in type K so what does this mean we'll want to use the startup type right here from types. DS without the property of author for now and then we can say and author is going to be optional and

02:42:42 it'll be of a type author which we also have to import from types you can also check those author and startup types because they're all generated for you in the types. TS file pretty cool right no need to do this manually also I believe we're using this in the home there we go startup card type so we can just import it because we have exported it from the other file so we can just do this so we can just import it right here by saying import startup type card from components startup card oh looks like we we already

02:43:19 have an import from the startup card so I can just add it right here by saying comma and then get this as well and now if we Define this type we can say post is of a type startup type card there we go you'll notice now that our typescript is complaining just the tiny bit saying that property ID does not exist on type author well let's check it out if I go to author we can see that ID is here as a string but ID is optional so so instead of destructuring these properties automatically what we can do

02:43:53 is just destructure the author and then here instead of author ID I think we're calling that in two places yep author ID we can say author question mark dot uncore ID now we're good and here we can use the author question mark. name to ensure that it will be there before we call it finally it's complaining a bit about the category saying that category is possibly undefined so I will add a question mark right here so it doesn't break her app if we don't have it great now you know how to fetch new posts from

02:44:27 the database through sanity's grck open- Source querying Language by first visualizing your queries in sanity Studios Vision tab then creating them independently in our code calling them in a single line to see all of those startups and even doing automatic type safety using santies type gen great work in the next lesson we'll dive a bit deeper her into how next GS caches our data and how we can further optimize it depending on the type of our application I'll show you specifically what's the best use case for the type of the

02:44:59 application where you want to get new posts shown immediately so let's do that next do you remember when we were setting up sanity client and we set this use CDN to true well this means that sanity will cash content for 60 seconds and then revalidate the content after every 60 seconds this is ISR incremental static regeneration this diagram shows how next GS cache is done but it works similarly for sanity first of all we make an uncashed request we try to fetch something setting the revalidation for

02:45:34 60 seconds it first looks into the cache to see if it can find the existing data but if it misses then it has to go to the actual data source to get the data and then it sets it to the cache if less than 60 seconds have passed after the set then making the same request to this URL will result in a cached request which means that we will not try to fetch the new data from The Source rather we'll just go to our cash data and return it but if more than 60 seconds have passed then this data will have become stale we'll revalidate go

02:46:09 back to the data source set this new data source to cache and then bring us back the data but let me show you how this works in action I'll split my window in two on the left side we have our existing Local Host 3000 application and on the right we have sanity studio now what would happen if we tried to create a new startup let's say by maybe copying this document and then creating a new one where we can paste everything we just copied and of course we have to change this lug to so I'll add one to it

02:46:37 and I'll click publish now if you go back and reload it will not appear not live and not even after many many reloads as you can see why is that happening well because it's cached and if you refer to this diagram we made a request to fetch the first post or all the posts at that time but when we did that fetch we got the data containing only one post because the second one hadn't yet been created but then even after we have created the second post we still try to refetch the data within 60 seconds which means that

02:47:15 it will not go to the new data it'll go to the cache to get it immediately so only if we reload the page after 60 seconds the post will have appeared now to always get new data live and in real time we'll have to go back to code and set to false to always get the new data so why is it even set to True by default well because when you're fetching from cash and in most cases that'll be good enough whenever you don't need real-time data such as for Block post or you could even argue that for our existing

02:47:46 application you don't need to see the new submitted startups every minute right so it's much faster to get the data from a CDN or from Cache but for the purposes of this video and to show you the latest and greatest of new nextjs and even sanity features we'll set it to false this way we'll get the latest data on refresh immediately but even that is not enough why get it on refresh when we can get it immediately without needing to refresh the page for that we'll use sanity's live content API allowing you to deliver

02:48:19 deliver live Dynamic experiences to your users without the complexity and scalability of the challenges that typically come with building realtime functionality to implement it within our application we can first clear our terminal run mpmi server only this is a package that will help us ensure that a specific module can only be used in server components next we can create a new utility file within sanity lib and we can call it live. TS within here we can import the server only package that we just installed and

02:48:56 we can also import Define live coming from next sanity as well as import the client which is going to come from at sanity SL SL client and then we can export const sanity fetch as well as sanity live by making it equal to Define live to which we pass an object containing the client we also have to quickly go to env. loal and change the sanity version to say next public sanity API version and in this case I'll set it to VX as we're using the latest features if what you have to type in here changes

02:49:45 I'll let you know somewhere below this video now we can go back to the homepage which is the page in the root folder and we'll just have to make one change to our sanity fetch instead of saying const posts is equal to client fetch now we'll change the bit by saying const data which we can rename to posts is equal to await sanity fetch coming from sanity lib live to which we can pass the options and then the query equal to the startup query no longer do we need the old fetch we can just use the new fetch this will

02:50:22 ensure to revalidate this page whenever new changes are made and with that everything is set we can remove this unused client import and we can go back to live for just a second to see if we have specified the import properly oh I think I'm missing a forward slash right here there we go that's better but you can see that we're still not using this sanity live variable so let's go back to the page scroll all the the way down and below the section let's just call a self-closing sanity live component we

02:50:56 can import it directly from sanity lib live that's going to look something like this we can save it and we are ready to test it out of course the only way to truly test it out is to create a new startup and see whether it'll show up instantly now sure we could have first created the create startup page and then you will be able to see the live changes but I just couldn't wait to to show this to you so one more time I'll split the screen with sanity studio and we'll create a new startup through there I'll

02:51:26 go to startups and I will copy all of the information about this document just to make the creation of the new one a bit easier I'll paste it and I'll rename it to something like new document and regenerate the slug now the moment I press publish we should be able to see it on the left side let's check it out publishing published and there it is it appeared at the top how cool is that well it was pretty simple to implement using sanity and it just works like it allows you to play with different nygs

02:52:01 rendering strategies giving you the full flexibility of how and where you want to show your data now you can add new data immediately on the homepage without your users needing to reload to see the new info and this was actually a pretty cool way to see exactly how nextjs do do caching or incremental static regeneration and so on hopefully this diagram and this practical segment of this video where we played a bit with trying to fetch data from the cache first and then making it real time made you better understand different data

02:52:34 fetching strategies in nextjs now that we have some posts in the homepage it is only natural to implement the search as well if I go ahead and search for Adrien or even just JSM right here you'll notice that right now it's not really working it's saying search results for JSM but it's showing us this one even though it doesn't contain JSM in the title so let's make the search work as you can notice when you type something in it actually modifies the query in the URL so first we need to retrieve that query within our

02:53:09 application and then further filter the fetch that we're trying to make we can do that at the top of the page. TSX using the search Rams we have already extracted the query right here so what we can do now is make more sense of it by creating a new variable called params which is equal to an object that says search is equal to query or null if it doesn't exist and now we can pass those prams as the second key and value pair to our options object into sanity fetch so let's go into the startups query and

02:53:46 modify the query in a way that if there is is a search it'll return the matching search otherwise it should return all results in a descending order so I'll add an additional and sign right here and we'll check if there is no defined dollar sign search we are referring to the search parameter right here if it's undefined or if category match the search so we're not only going to Surge by title but rather we're going to Surge by category to or if author name matches the search as well sometimes some people might want to

02:54:24 search by the author name so essentially what this part is doing here is checking whether a search exists or if search matches the category or if search matches the author name and of course I miss the most important part which is or title match search we're going to search by the startup title so this will simply filter the documents where the title category or Au name matches the search string using the match operator now if we save this go back and you can see we didn't even have to reload search

02:54:58 results for JSM actually show us the two matching JSM results whereas the new document is not included if I search for Adrien who is the author of all three documents we still get all three and if I search for new I think you can assume what's going to happen we only get one new document how simple was that everything works so seamlessly and super fast and don't forget that we also have this clear button which will clear the search term now another cool feature we can do is also filter by category so if I click

02:55:33 on a specific category right here it'll automatically set the query and the search term to that category if I quickly head over to studio and change one of these documents categories to something like travel and click publish back here immediately it's no longer showing for travel but you can see that it changed and I can only filter by travel as well everything works so seamlessly now that that is done just before we go ahead and create the form through which we can create startups from within the application I

02:56:10 want to make sure to see The Details page of each one of these startups that's the page that shows up when you click details right here right now it's just a blank 404 so let's turn that 404 into a beautiful startup Details page just like this to get started with the details page let's open up our file explorer and let's create a new page within app Root I'll create a new folder within the root called startup and within startup we'll create another folder this will be a dynamic r route so I'll give it a name of square

02:56:51 brackets ID and within that folder I'll create a new page. TSX now if you're doing this for the first time this might seem like a lot of folders but trust me it'll all start making sense very very soon the reason why we're doing this is to expose our page on the URL slash startup SL2 or three or whatever the ID of that startup is so we can show a new Dynamic startup Details page for each different startup within this page let's run ource to create a quick page and there we go it immediately appears under this URL so

02:57:32 now if you go back home and if you click on any one of these you can see that it automatically renates you to Startup and then the ID of that startup now do you know how we can extract this ID from the URL and get it right here within our code well we can get it through pramps so let's d structure the pams and let's also specify the type I'll set the pams to be equal to a promise which will return an ID of a type string that'll look something like this how do we know it's an ID because we name our folder that way then we can

02:58:07 say const ID is equal to in parenthesis a weight for rams. ID and since we're using a weight we have to turn this into an a sync function now we can return an empty react fragment which is going to look something like this and within it we can return an H1 that will have a class name of something like text- 3XL and within it we can say something like this is a startup number and then we can dynamically render it ID if you do that and go back you can see this is a startup number and then we get the ID

02:58:48 but this on its own is not super useful we need to be able to take this ID and then fetch all of the details about that startup things like the date created the title description the image the author all of that good stuff so how can we do that well for a second let's create a new tab and go to localhost 3000 SL Studio we can go to vision and we can modify our query a bit to now not fetch all the startups but rather to fetch startup deta details the query will look something like this give me everything

02:59:22 where a type is equal to Startup and uncore ID is equal to dollar sign ID and then here's the key part only give me element that matches that query then for each one of these elements return the ID title slug created at author with it's ID name username image and bio give me the views description C category image and there's also the pitch which I think we're missing here we might also be missing it in all in the query for fetching all startups now if you run fetch like this it'll say you provide

03:00:01 the pram ID but you didn't really give me the value for it so sanity Vision allows you to pass the params right here so going back to our application we can copy this ID and we can now paste it right here within a string so use single quotes right here to turn it into a string and run fetch one more time we get null and I think that's because our ID got parsed to show nicely in the URL most likely this was a character that wasn't easy to parse as a URL so it's getting shown this way that's not a

03:00:35 problem we can get a full URL from the structure by going into startups and then we can inspect it right here if you do that you'll get the entire thing along with its ID so here we have the correct one so if we go back to Vision you can now pass the correct ID right here and now we get the complete startup details so let's go ahead and copy this query and let's bring it back to our code we'll use it within sanity lib queries and right below the startups query I'll create a new one by saying export const startup by ID query is

03:01:14 equal to Define query where we pass in a template string string and right in there we pass the full query oh and I was partially right when I said that we're missing the pitch right here we indeed are missing it it's not like it is here but we don't actually need it so this is the beauty of gr quering language in a sense that it allows you to get only the data that you need on the homepage where we're showing not startup details but only the most important information about the startup we don't necessarily need to show the

03:01:44 pitch so we don't fetch it but here for the details we definitely do fetch it so now that we are exporting this query we can use it on the project Details page but before we do that I want to go over one thing with you we could have also used sanity live fetch here but it's not like you're going to be on the details page and wait for the changes to happen once you're there you wouldn't expect them to happen live right because you're viewing a specific version of that page and I also wanted to show you how you

03:02:15 can Implement different rendering strategies on the same page and use one of which is the PPR strategy partial pre-rendering enables you to combine static and dynamic components together in the same route it's pretty crazy and it's completely new during the build nextjs pr- renders as much of the route as possible and only if Dynamic code is detected like reading from the incoming request you can wrap the relevant component with a react suspense boundary the suspense boundary Falls fall back will be included in the

03:02:50 pre-rendered HTML so nextjs here shows an example of an e-commerce store where we have a Navar which is completely static or revalidated same thing for the product information static or revalidated in some kind of a time frame like every 60 minutes seconds or whatever it is but in general it's static but the cart and the recommended products can be completely Dynamic only that part while the rest can be static to to use all the benefits that I mentioned so far like speed efficiency better developer experience and also SEO

03:03:25 benefits that it offers and I would highly recommend watching this 11-minute video by delba where she visually explains partial pre-rendering these are some very nice Graphics that allow you to fully understand how this is working but for the time being I'll show you how it works in a real example pink dots right here denote artificially delayed responses for demo purposes like shipping estimates which you can see right here recommended products and reviews these are always going to be dynamic because they have to make a

03:03:57 request to some outside Source such as a postal service to know when it can get shipped same things for recommended products because some algorithm has to be ran to check out your preferences and shopping habits and finally there's the customer reviews which are always going to be dynamic so now check this out if I reload see how this loaded immediately because the product information doesn't really change that often and you have it right in front of you then this loads in 200 milliseconds and this one loads in

03:04:29 500 milliseconds pretty crazy stuff right you can choose what you want to show dynamically and what will be there immediately for the users cached and coming from a CDN next js's PPR really is the latest and greatest of rendering strategies out there as it allows you to combine the best of both worlds so now let me teach you how to add it to your apps first head over to next config TS and here we'll add an experimental tag because it is experimental right now but soon enough it'll become stable and here

03:05:02 you can say PPR and set it to incremental we can also turn on some additional Dev indicators such as app ISR status is set to True build activity is also set to true and build activity position is set to bottom right these will help us visualize what is happening with PPR next back in the startup Details page we have to export const a new flag called experimental PPR is equal to true and now we can use sanity's client API to perform incremental static regeneration or ISR to get the startup details we can

03:05:42 do that by fetching the post based on the provided ID const post is equal to await client. fetch we pass in the startup byy ID query and we pass in an object where we pass the ID as the first and only parameter finally if there is no post we can return a not found this is coming directly from next navigation else we can return something else from the post now for example we can render a post. tile see how typescript immediately knows that we actually do have a title on the post going back to Local Host and

03:06:24 clicking on one of these posts opens up a 404 this page could not be found oh that's happening because no post was returned so we redirected to a 4 or4 but why is that could it be that our query is good but it actually cannot find a post under that ID similarly to what happened when we were trying to query it with Insanity Vision let's try to conso log it to see what we're getting back I'll cons log this ID right here save it and click on one of these posts right here as you can see we get the full ID

03:06:57 but at the end we have this percentage sign character even though in the original ID it doesn't seem to be there I also opened a second post that we created and would you take a look it ends with different numbers but then it has the same percentage 7D appended to it at the end which makes me pretty sure that I already know what the problem is can you catch it try to debug it with me when you click on the details of any one of these cards it appends an additional character to the ID as you can see right

03:07:30 here so where's the issue let's try to pinpoint and centralize it is it in the details well yes most likely so if we go to the code and if we go to the startup card take a look I made a mistake you most likely didn't have this mistake you most likely properly wrote it I hope you did but I added an extra curly brace right at the end of this string so if I remove it and click details perfect we get a title of each different document even though you might not have had this issue on your end I hope this little

03:08:04 debugging session was useful but with that in mind the fact that we're now getting a title means that we're successfully fetching post details from sanity with the PPR strategy enabled in the next lecture will code out the UI of the startup Details page and I'll further explain which parts can we leave as static and which ones will make Dynamic to utilize the full power of VPR great work so far let's get started with startup Details page by creating a section right here at the top this section will have a class name

03:08:43 equal to pinkcore container we've seen that before and know exactly ly what it does I'll also give it a exclamation mark m-h 230 pixels which will overwrite it to a bit of a smaller value there we go that's looking good right within it I'll create a P tag that'll have a class name equal to tag and it'll show a formatted date so let's call a format date function coming from our lib utils and pass the post question mark doore created at property right within it and there we go October 14th 2024 next

03:09:21 let's move this H1 right within it and we'll change the Styles just a tiny bit by setting the class name to be equal to heading there we go that's already so much better right below it let's create another P tag that will have a class name equal to subheading and it'll also have a Max W of 5 XL with an exclamation mark at the start and that will render the post dot description there we go look looking good right below this section we'll create another section and this section will have a class name

03:09:54 equal to section uncore container within which we can render an IMG tag with a source equal to post. image there we go that's looking good we can also have an ALT tag of thumbnail and a class name equal to w-o h-auto and rounded D excl looking good right below it let's create a div and that div will have a class name equal to space- y-5 margin top of 10 to divide it a bit from the top Max W of 4 XEL and a margin EXL Auto and right within it we can create another div to help us with positioning with a class name equal to

03:10:42 flex between and a gap of five in between the elements within there we can render a link of course only after we import it from next link and give it an hre of sluser slost do author question mark. ID so we're creating a link to point to the author Details page which we'll soon create let's also give this link a class name equal to flex gap of two items Das Center and the margin bottom of three within it we can render an image with a source of post. author. image with an Al tag equal to Avatar a width

03:11:30 of 64 a height of 64 and a class name of rounded daso to make it a full Avatar and drop shadow LG we have to import the image tag from nextjs and if we save this now you'll see see a great looking profile photo right below this image let's create a div within which we can have a P tag with a class name equal to text- 20-m medium within which we can render the post. author. name and we can also duplicate this change the text to something like 16 and also give it text black of 300 with an exclamation mark within which we

03:12:15 can render at post. author. username so we can show both the name and the username right below it of course the author page doesn't yet exist but it will soon let's go below this link and let's create another P tag that'll have a class name equal to category dashtag so I think you know what it will render the post. category here we go perfect now right below this div we can create an H3 that'll have a class name equal to text D30 D bold and it can say something like pitch details or startup details if

03:12:57 you will and right below it we can render the pitch details which come in a markdown format to parse and convert markdown into an HTML string we need to install an additional package it's this one right here called markdown it and it says it's a markdown parser done right fast and easy to extend you can just in install it by running mpm install markdown-it and then you can use it very simply so let's do it together I'll open up the terminal clear it and run mpm install markdown-it once it gets installed we

03:13:34 can get the pars markdown content right here at the top by saying const pars content is equal to MD which we have to import at the top by saying import markdown it from markdown it then right here we can Define MD is equal to markdown it and finally on this pars content we can say md. render post question mark. pitch or an empty string in case it doesn't exist so this will properly pars the markdown content so we can display it as HTML and you can see that markdown it is complaining a bit saying that we don't

03:14:19 have the necessary types for it so if you hover over it it's going to give you the command to install the type declarations for the library so just copy it and paste it in the terminal then the warning will be gone and you'll have all the necessary types great now that we have this parsed content we'll have to set it as HTML so let's do that right here below this H3 by checking if we have access to to the par content if we do we can render an HTML 5 semantic article tag which can be self-closing in this case I

03:14:56 think we should be good and on it we can use a dangerously set inner HTML property now react normally escapes any HTML to prevent xss attacks cross side scripting attacks rendering the content as plain text but when you want to insert raw HTML like the parsed markdown you must use dangerously set inner HTML to tell react that the content is safe and should be rendered as HTML so right here we can Define uncore uncore HTML to be equal to par content we also need the second part of this stary and here we

03:15:34 can say ptag with a class name of no result which can say no details provided if we save it you can see Pitch details and you can see all the testing markdown that we have passed using the sanity Studio markdown editor we can style it further by giving this article a class name of pros this will allow tailin CSS to automatically change a lot of different styles to make it more readable and to actually parse it there we go this is looking so much better let's give it a Max W of 4 XEL so it doesn't take the full width of the

03:16:11 screen on larger devices font work sense to match our application and let's give it a break-all which will apply the word break property great now we can go below this div and we can create an HR a horizontal rule with a class name equal to divider to divide the pitch details from the next section later on right here we'll show editor selected startups which are some recommended startups for us to check out since we checked out this current one we're viewing so we can kind of continue checking out additional

03:16:48 ones while staying on the app so for now I'll turn this into a to-do so we can implement it later on but let's go below this section and let's create another very small but very very important section and that one will make the fact that we're using PPR on this page makes sense because everything we have rendered so far is static content whatever the pitch details we have the thumbnail the title we don't need to constantly dynamically refetch or revalidate we're okay that sometimes this data is stale and can be changed

03:17:21 later on but we will Implement an additional piece of this page that we need to update frequently basically in real time it'll be completely Dynamic so as you learned from the start of this video whenever you want to make something dynamic in PPR you have to wrap it in a suspense coming from react and that's actually a react feature allowing you to provide a fullback in case we cannot render something something new or something to show while that something new hasn't yet rendered or been fetched so if we cannot yet

03:17:54 fetch it we can render a skeleton property coming from shaten so let's go ahead and install it by running MPX shaten add latest add skeleton there we go it has been added and we can now import it right here at the top coming from components UI skeleton and suspense is of course coming from react so make sure to properly import it we can actually add it right here at the top to this skeleton we can also provide a class name equal to view- skeleton and within the suspense after you have given it a fallback you can choose to add the

03:18:34 code that will be rendered dynamically so for that piece of code let's actually create a new component in the components folder I'll create a new file called view Dot TSX I'll run rafc and I'll now render that component right here within the suspense by saying view coming from add components SL viw and to it I'll just pass the ID equal to the ID this is the ID of the post we are currently on so what kind of view am I even talking about here well if you check out the final version of the application check out this little thing

03:19:15 at the bottom right I know it's it's super super small but once again I really wanted to show you how we can make PPR truly shine this piece of data will be rendered dynamically whenever it changes in real time thanks to sanity of course but the rest of the page will be completely static exactly as that nextjs example where they had an e-commerce store where we had the product details which were render statically but then some additional posts or views or whatever it was was rendered dynamically

03:19:46 so now we can go into the view and we can develop the dynamic part of our PPR page that's going to look something like this we can first destructure the ID from props and say that it's ID of a type string then we can return a div with a class name equal to view container within which we can render a div that'll have a class name of absolute minus top-2 and minus wr-2 can you guess what will go into this container well it'll be that little ping that you can see right here this light indicating to us

03:20:23 that it is live so to implement it I'll actually create another component in the components folder and I'll call it ping. TSX run rafc and I will import it right here within the div by saying ping and calling it as a self-closing component below this div we'll render another P tag with a class name of view text within which I'll render a span that'll have a class name of font Das black that'll render the total number of views so for now let's simply render 100 as a static number and say views if we go

03:21:01 back to application you can see 100 views and then ping right here at the top right that's good all good things take time so now we can dive into ping and we can Implement that little pinging light by giving this div a class name of relative with within which we have another div with a class name is equal to Absolute minus left- 4 and top-1 so we can properly position it within which we have a span that has a class name of flex and size- 11 pixels within square brackets within which we have another

03:21:38 span with a class name equal to Absolute inline-flex h- full w- fo animate dping rounded Das full BG primary and opacity of 75 there we go you can kind of see it right now at the bottom right and below this span we'll have another span that'll have a class name is equal to relative inline-flex size-1 pixels same as before rounded Das full and and BG primary so basically we'll have one that is always active and then we'll have one that pings indicating it's live interactivity great this is now looking

03:22:29 good now we have to write a separate sanity query to get the total number of views for a post with the given ID to do that you already know the drill we have to go into sanity queries where we currently have two so we can create a third one by saying export const startup uncore views uncore query is equal to theine query to which we pass the actual query this query will be a bit simpler we'll say something like give me everything where off a type double equal to Startup and if the underscore ID is equal to dollar sign ID

03:23:11 and give me only the first element and only return the ID and the views pretty simple right now we can copy this query go back here and say const in curly braces views which we can rename to Total views is equal to a weit client coming from sanity do withth config to which will pass use CDN is set to false so you can also manually define whether you want to use CDN or not with inline configuration ation now let's turn this into async since we're using a weight right here there we go and finally after

03:23:53 the width config we also have to add dot fetch so which Creer are we fetching we're fetching these startup views query to which we have to pass params of ID now let's make sure to properly close this right here looks like I had a typo and this is now looking so much better and it makes more sense we also have to add the ID as a Pam perfect and now we can get access to the total number of views and dynamically render it right here currently we have only one views we can do some additional parsing to remove

03:24:29 the letter s in case it's a singular number a quick trick is to just say views and then say colon that way views one views two views no matter how many it's all good that's if you want to be lazy but I challenge you to create a function called format number that actually takes into consideration whether a number is singular or plural or whether it needs an S at the end or not and then adds it correspondingly with that in mind and considering the fact that we specifi the UCD into false the number of views whenever it changes

03:25:02 will automatically be reflected on this page later on I'll also add a little to-do right here to modify or update the number of views whenever somebody sees this post more and that soon with that said we have successfully implemented the dynamic part of the startup Details page and the static part has been implemented too which leaves us with the completed startup Details page of course we have to still update the views and then show other relevant posts similar to this one we'll do that soon but for

03:25:36 now this is great so next St we'll tap into sanity right client functionalities meaning being able to modify some data directly within our application this will allow us to create new startups but even sooner than that it'll allow us to update the number of views so that we can see the full benefits of PPR so far we've implemented PPR partial pre-rendering on the startup Details page but we can't really see any difference yet as everything seems static as we're not updating any kind of data to increase the number of views in

03:26:14 our database at the exact moment somebody visits the page we'll have to set up a new sanity right client that allows users to perform right operations so far we only performed read operations now to set up a right client in sanity we need to generate a token with right permissions through the sanity manage website so visit your dashboard navigate to the sanity project you've created head over to API go to tokens and add a new API token specify the name something like create and update startups and give

03:26:49 it the editor access the ability to write access to all data sets and click save copy the token info you were given and head over to env. loal there you can add sanity write token and make it equal to the Token you just copied notice how this one doesn't have the next public well that's because this is a more serious action which not everybody should be able to perform and and it can only happen from the server side nextjs will automatically reload all the envs as soon as this happens now head over to

03:27:25 sanity env. DS that's this file right here and below the project ID also export const token and make it equal to process. env. sanity wror token next we have to create a new file under sanity lib and as we have created client. TS now we need to create a new file called Write client. TS to create it we can copy what we have here in the client and paste it for the right client at the top as I have already mentioned this code can only be run on the server so we're going to import server only all of the

03:28:10 other things which we're importing are going to be here such as the API version data set project ID and in this case we also need to get the token so we can say export con write client create a new client with the project ID data set API version use CDN set to false and finally we also have to give it a token we can also add one fail save to say if there is no bright clientconfig and then. token after dot in that case we can throw a new error saying something like write token not found just so we know what's wrong and

03:28:58 now that we have access to this right token we can actually finally update the number of views by going to the view component we can remove this to-do and say await right client Dot and we can call a DOT patch on it patch is used for updates we want to patch a document with this specific ID and we want to set the number of views to be equal to Total views + one and we want to commit that action by saying do commit and that's it with this approach these two requests will execute sequentially and you won't see anything

03:29:41 on the UI until they are executed instead you'll see the skeleton to to avoid that and to run this update view in the background while we see the rest of the results immediately we can use the unstable after functionality allowing you to schedule work to be executed after another response is finished this is useful for tasks and other side effects that should not block the response such as logging and analytics or a perfect case updating the number of views it can be used in server components server actions route handlers

03:30:15 and more and it looks something like this import unstable after as after and then you call it in this case we want to schedule the work after our response to getting views is done we'll then update the views in the background without blocking the UI to do that we just have to do this import unstable after as after from next server and then wrap this await into after close it like this and set that into its own async function that is it now if you go back to your application you'll notice that unstable after must be explicitly

03:30:55 enabled by setting the experimental that after to true in our next config so let's head over to next config and here along with PPR we can also set after the true if you do that and reload the error is gone and the number of views switched to two check this out I'll reload a couple more times check how gray this is the rest of the content isn't even changing and it's here immediately doesn't feel like anything is happening like if I go back and if I go to this document I mean it is just super quick the only part of the website that

03:31:36 updates is this little part at the bottom right which is the number of views super cool I think I'll continue reloading it a few more times but even at this point it still may not be clear that this is PPR right so I will actually demonstrate it to you I'll open up sanity Studio on the right side and keep looking at the project details on the left I'll head over to startups and I'll find this last startup that I updated we can see the number of views is 22 now I'm going to change the title of this startup in sanity studio and

03:32:09 reload the page check this out I'll change it to something like new JS mastery. proo platform yep that's a cool new startup we're working on so let me click publish and even if I reload well it changed immediately it's possible that I hit just the right reload time but if I change it again to something like new new new Js Mastery Pro platform and click publish if I reload well it changed the immediately looks like the news about the new upcoming platform can't wait to get leaked but let's see why is that

03:32:52 because right now it seems that everything is live and not cashed at all we are fetching the number of views right here using the client and we specifically said the UCD and fals that's okay but what about these startup details so if we go to Startup details here we're using the regular client and this client oh it has a UC and set to false when we were testing something we set it back to false just to show it but for now I can set it to true so it'll actually cache things so now if I go back and change

03:33:30 this to something like brand new Js Mastery Pro platform and click publish and then reload here you can notice that this will not actually update for another 60 seconds that's because the data is cached it's coming from a CDN the views are indeed updating the title stays the same and that my friends is PPR for you hopefully now you understand how this is working behind the scenes the startup details use ISR incremental static regeneration which revalidates the page every 60 seconds so any change made in stti studio or

03:34:11 editing the database will make the changes appear on the website once the cach is refreshed meanwhile views use SSR service side rendering providing fresh data with each user request so if I reload 60 seconds have passed we get the new data and now it's going to be cached until it changes perfect that was a good one now you truly understand how to use PPR next we will revisit the author authentication flow so we not only log in using Google allo but we actually create a real author in our database that will then be capable of

03:34:50 creating new startups directly within the YC directory app let's do that next I've shown this graph to you before right and basically what it says is depending if there is a session or not we have to make sure that the user that is authenticated also is created as an author within our database and if they're not we need to create one in their name so to do that we'll have to create a sanity query to see whether an author with a specific GitHub ID exists let's head over to queries and let's create a new query by saying export

03:35:29 const author by GitHub ID query is equal to Define query and we can say something along the lines of give me everything where underscore type is double equal to author and the I ID of the author is equal to dollar sign ID then give me only the first element that matches and for that first element return the following things an underscore ID the ID name username email email image and bio now let's go over to o. TS and we have to write some call backs these are functions that are executed after successful authentication by next off in

03:36:18 this graph that callback would be somewhere right here where we're authenticating and when we get the successful information about the user currently we just create a session and return it but now whenever we create a session we also want to do this check that we just created the query for so alongside providers create callbacks which is an object and create a first call back async sign in to check whether our user already exists in our database or not and then depending on that created right here we get access to the

03:36:54 newly authenticated user their account and their profile we can check whether this is an already existing user by saying con existing user is equal to await client. fetch author by GitHub ID query to which we pass params as ID and of course this client has to come from Sandy specifically this ID is going to be referring to the profile question mark. ID coming from GitHub ooth now we can check if there is no existing user then we can use sanity right client to create a new user document or new author document by saying

03:37:41 await write client which we have to import from sanity create where the type is equal to author ID is set to profile question mark. ID name is set to user question mark. name username is set to profile question mark di login email is set to user questionmark doil image is set to user mark. image and bio is set to profile question mark. bio or an empty string if it doesn't exist now you can notice how I had to actually repeat user and profile many times what would have been better is to Simply extract information from this

03:38:31 user or profile by destructuring it so we can destructure from user the name the email and the image and from profile we can destructure what ID login and bio now if we do that we can remove all instances where we mention those things and we can just refer to those things themselves and if you have the same name of the key and the value that means that you can just refer to it like this without specifying the name it's just like this but for username it's going to be login so we have to specify it still

03:39:12 still much cleaner than it used to be finally we can go below this if statement and then return true to continue the sign-in process after a successful signin we'll need to create an author ID from sanity to use it for our profile or when creating a new startup so let's modify the default JWT token and add the author ID to it we can do that by creating a second call back right here right below the async sign in we can create async JWT where we get the token the account and the profile there we can check if

03:39:53 account exists and if profile exists then we can get the user from sanity by saying const user is equal to a weit client. fetch author by GitHub ID query where we specify the ID to be equal to profile question mark. ID oh and I just noticed above we destructure the ID from profile so we don't have to explicitly mention it here we can just say ID now we can extend this ID with the user ID by saying token. ID is equal to user doore ID and finally we can exit out of that if and return the token this

03:40:35 will allow us to connect a specific GitHub user with a sanity author that can then create a startup finally in order to use the ID we need to create a third callback function called session where we get access to a session and a token and we need to pass the profile ID from the token to the session by saying object. assign session where we set the ID to be equal to token. ID and then we return the modified session great now we can go to any page for example we can go to our homepage and here we can extract a session and

03:41:22 from it we can get the sanity ID of the author for that user so let's do it by saying const session is equal to await off coming from at SLO and if you try to console.log session do ID you'll see that typescript will complain a bit say saying that session is possibly null we can easily fix that by creating a new file right here in the root of our directory and call it next o or next- o.d. TS within it we can declare a new typescript module called Next o which will have two interfaces interface session that'll have an ID of

03:42:14 string and it'll also have an interface JWT which will have an ID of string as well if you do that the session now knows that it has an ID so let's give it a shot now if you go back to the homepage you'll notice that the only thing you have to do to get rid of this warning is to add a question mark right here and you might have noticed that on my screen there was an error right there 5 Seconds ago but now there's no error well sometimes nextjs will throw some random errors as I'm still working on the

03:42:52 experimental version of nextjs so just so you know if something weird is happening for you too and you cannot find where the error is originating from just try to reload your terminal and then run it one more time it might help just to fix things you know turn it off and then turn it on again type of situation but with that in mind if we do that and you reload on the homepage you should see a conso log for this session initially the conso log should be undefined and we can see undefined right here that's because we were left logged

03:43:26 in before we created all the functionality to create a new ID to hook it up with the author so to fix that let's log out and let's log in one more time and there you'll see a server error problem with server configuration if you open up the terminal you'll see that it's coming from o and specifically it's complaining about not being able to find the underscore ID so we might need to add a question mark right here saying that sometimes the user might not be there but why would it not be there in

03:44:02 the first place let's check our query to be sure we are trying to fetch the author by GitHub ID query by defining the query that gets everything of a type author and the ID and the ID is equal to dollar sign ID where we get the first element and then we return all of these properties for it this is looking good to me so let's give it one more shot but before we do you have to make sure that the author hasn't been generated or if it has we'll have to clear it by deleting it so now if we try to log in one more

03:44:41 time oh it's actually asking us whether we want to authorize it which is great so let me authorize my user we're getting redirected which is good we get the same information right here at the top as before but this time if you go to sanity Studio to authors you'll be able to find a new user with complete oath data populated such as the name username email image and the bio coming directly from GitHub but a bigger question is can we see that session ID D in our console log and for the time being the answer is no

03:45:20 it is undefined so let's debug it further we're not getting the result we want we create a new user on signin and that user indeed gets created in the database but if we try to read that value within the JWT it returns undefined even though the user has been created successfully in sanity studio and even though we've had an issue with this optional chaining operator that's not to blame even adding some additional checks like if no user then do something else no that wouldn't fix it this issue is rooted deeply in

03:45:54 how sanity and more importantly nextjs truly work behind the scenes specifically their caching mechanisms when we first created a new user after confirming they didn't exist sanity successfully added the user however when we immediately attempted to retrieve that user within 60 seconds of cre creation the query didn't return any results this is because the read query was made too soon after the user creation and sanities and next js's cache hadn't yet been updated this is a common challenge when working with

03:46:29 Frameworks or libraries that cash data and if you're not familiar with how and when caching occurs it can lead to confusion and frustration when queries don't return the expected results and you know them for a fact that they're there without a proper understanding of cash you might find yourself stuck and discouraged this is why learning about cash management is crucial you cannot say you know next GS until you can for a fact know exactly how its caching mechanism works and within the ultimate

03:47:01 nextjs course we dive deep into how caching works because I know how big of a problem it was for me the developers that work alongside me on all of these projects and all the other developers out there which are simply saying that nextjs obscures and abstracts everything and just doesn't work well it's not that it doesn't work it's that they don't understand it yet so if you're having trouble understanding cash and you want to dive deeper into its inner workings pause this video and check out the

03:47:31 ultimate nextjs Course once you do that let's go ahead and fix this issue back in our callbacks we have to add use CDN false to both sign in and JWT callbacks so here where we're calling for existing user we can say say client dot with config where we can pass the used CDN is set to false and then call a fetch on it similarly we can pass it when fetching the user right here client dot with config where we pass in the UCD and false and only then do we fetch if we now save this close everything because

03:48:12 we're expecting it to work go back to San and delete the existing user log out and give it one final shot let's see what we come up with and before I log in I'll make sure to clear the cash I'll do it right here clear cash and clear cookies and all that good stuff you can also do it via inspect element by going to app and cache finally let's log in okay it automatically logged Us in which is great the sanity user has been created with all of its great oo GitHub data that's great but now for the Moment of

03:48:51 Truth do we have the session ID within our terminal and the answer is yes here it is if you didn't know about nextjs caching you can spend hours on issues just like this because you can see the data for a fact it is here but your nextjs is telling you that it's not no it's not that nygs is just trying to make sure that your app is as efficient and as optimized as possible but it's up to you to control the Beast so once again if this is still a bit unclear and you want a deep under the hood dive into

03:49:25 NEX gs's inner workings check out the ultimate nextjs course more than 4,000 developers have learned from it so far and love it and I'll always continue updating it with the latest versions of nextjs the link will of course be in the description but with that said even by watching this video you might already understand some of the intricacies of caching thankfully we have fixed this issue and we are ready to proceed in the next chapter we'll focus on creating the create startup page allowing us to

03:49:56 create new startups directly from YC directory app not necessarily needing to go to sanity Studio to start creating the create startup page we have to create a new route in our application for that we'll go to app rout and then Within startup we'll create a new folder called create and within the create folder we'll create a new file called page. TSX you know the drill I'll run rafc in there to quickly spin up a simple react functional component and then I'll head over to create which will bring me to

03:50:35 the page that we just created within here I'll turn this div into an empty react fragment and within it I'll create a new section this section will have a class name equal to pinkcore container and m-h Das in square brackets 230 pixels within it we can create a new H1 and give it a class name equal to heading and within it say submit your startup pitch there we go that's looking better or we can say submit your startup now right below it we want to have a new component which is going to be a form so let's go ahead and

03:51:20 create that form by creating a new component in the components folder which is going to be called startup form. TSX run rafc and then import this form right below the section as a self-closing component startup form there we go and of course make make sure to properly imported perfect there we go it's looking good and we only want to be able to visit this page if we are logged in so let's add one more fail save by saying const session is equal to await o coming from next o like this we have to turn this into a sync and then we can

03:52:07 make a check and say if there is no session then we can redirect and this redirect will be imported from next navigation and it's going to point to just home forward slash perfect so now if somebody's unauthenticated and they try to manually go to Startup create it'll actually just bump them up to the homepage because they can view but not create different startups great so now let's dive into the startup form and let's start implementing it our form will use quite a few different shat CN components so

03:52:41 let's go ahead and install them one by one we can do that by running MPX shaten add latest add and we can add the input the text area the toast component which is going to be for little alert once we submit or once we have an error and we'll add other ones as we go if we remember to add something else as well now we can develop the UI of the form let's start by turning this entire div into a form component like this this form will have an action which for now I'll set to be an empty callback function let's also give it a class name

03:53:20 equal to Startup D form and you notice that as soon as we Define some kind of an action it's going to ask us to turn this into a client component so let's actually add use client right here at the top right within the form we'll have a div and we'll use that div just for structuring our elements within the div we'll have a label with an HTML 4 property equal to title so this will be a label for the title with a class name of startup D formore label and it's going to say title right below the label I'll render

03:53:56 an input which is going to come directly from shaten meaning add components UI input like this it's going to be a self-closing component that will have an ID equal to title a name equal to title a class name equal to Startup Das form on \_ input it'll be required and it'll have a placeholder equal to Startup title there we go that's looking good right below it we can check whether we have any errors on our form so let's create a new use state right here use State snippet which we need to import from react and we'll say const errors

03:54:37 and set errors is equal to use State at the start equal to just an empty object so now if we have any errors so if errors. tile exist then we'll render a P tag with a class name equal to Startup D formore error and it'll render errors. tile perfect right now our typescript is not sure whether title exists on this errors object so what we can do is specify the type of this Ed state right here before the opening parentheses and we can set it as record string string so then it'll know that it contains Different Strings within this

03:55:25 object now this is the field for the title and we might want to replicate this for other fields as well we want to do it for the description we want to do it for the category image link and then the pitch itself will be the actual markdown but for now let's duplicate this entire div at least three times so I'll copy this one two 3 there we go let's divide them a bit with some space and the second one will have the HTML 4 description and it'll say description the input itself will actually be a text

03:56:01 area so let's import it from components text area the ID and the name will of course be description instead of startup form input it'll be startup form text area required and placeholder can be something like startup description there we go for the errors you know the drill it's going to be errors. description and at the end we will render the errors. description as well great two inputs done two more to go below description we'll render a label HTML 4 category startup form label that's going to say

03:56:45 category the input for that category will be category the name will be category as well and we'll say something like startup category we can give some examples so that they know what they have to enter like Tech health education and so on and we'll render errors. category and errors. category here as well and after that we'll have our image link so let's render the HTML 4 Link and say image URL change the ID to link the name to link as well and we can say something like startup image URL and finally we'll render the errors.

03:57:32 Link and errors. Link right here as well and we have four different inputs great now below these we'll need to have a pitch and this will be the actual markdown which will give us a lot of different capabilities so we can further optimize and style how we want to portray the pitch of our startup you can see it in real time how it looks like you can enter different code blocks and you can even enter inline images which is pretty cool so it gives you a lot of flexibility in how you want to present your startup so to create this

03:58:08 markdown component we'll use UIW react MD editor which is a simple Mark done editor with preview view implemented with reactjs and typescript let's go ahead and install it together by running mpmi at UIW SL react D md- editor and here we can see how it can be used we can import it right here at the top of the file we need to Define its state or the value in this case I'll rename it from value to pitch and set pitch that's going to be used State and finally we'll be able to render it like so so let's scroll a bit down and let's

03:58:50 actually duplicate the entire div one final time for this pitch element but this time we'll give this div a data color mode and set it to light so it always must be light give it HTML for pitch change this to pitch we'll remove this input and instead of the input we'll use this empd editor that we have here we can change the value to pitch and set the onchange to set pitch and for the errors that's going to be errors. pitch as well as errors. pitch right here in this case I believe we have to set it as a callback

03:59:32 function that gets access to the value and then we can call the value as string just to make sure that typescript is happy in this case there we go now now we're good so if you go back to the create page and reload you should be able to see a very simplistic but nice looking markdown editor which has the preview mode enabled so you can see exactly what you're doing in real time now let's TI it further and give it additional features we can give it an ID equal to pitch we can also give it a preview

04:00:07 equal to edit a height of about 300 pixels to give it some more space we can give it a style of border radius of 20 to make it fit along our other elements better and an overflow of hidden there we go now it's a bit more organic we can give it a text area props specifically change a placeholder to be briefly describe your idea and what problem it solves and we can also give it a preview options which is an object where we can set a this allowed elements and we can disallow The Styling so we're only going to keep the base marked on

04:00:54 properties so if we reload and remove this hello world you can see that it says briefly describe your idea and what problem it solves finally at the bottom below this div let's render a button coming from components UI button let's give it a type is equal to submit as it will submit the entire form and a class name equal to Startup D formore BTN there we go now when submitting this form it'll take some time it won't be an instantaneous action so let's create a field const is pending which for now I'll set it to false later

04:01:31 on we'll extract this value dynamically to know whether we're submitting the form or not I'll also remove this hello world from the pitch so we have a clean and empty slate so going back to the button we can now make it disabled in case it is currently pending meaning something is happening also if it is pending will change what it says it'll say submitting dot dot dot else it'll say submit your startup or your pitch and let's also render a send icon right here which will have a class name equal to size-6 and margin left of two

04:02:13 and we can also get it a text- white so the contrast is a bit better there we go let's see why this startup form is complaining it is saying that we have multiple default exports let's see if that really is the case hm it seems to me like we only have one if I close the file and then reopen it looks like the error is gone great and with that the UI of her form is looking great so now we can focus on submitting the form and we'll submit it you using reacts latest use action State hook a hook that allows

04:02:49 you to update the state based on the result of a form action it is a hook that simplifies the process of managing form States and form submissions you don't have to write too many used states it is designed to work seamlessly with server actions allowing you to update component State based on the result of the form action it even exposes a special is pending state that can be used to show a loading indicator while the action is being executed and this use action State Hook is even better and it's aim to replace the react Dom's used

04:03:25 form State hook as it caused some confusion and limitations so this new hook fixes those issues by renaming use form state to use action state it adds an additional pending State and it moves the hook to the react package overall a very good update in my opinion so let's explore it in a bit more detail we import use action State Hook from react and you use it like you would typical use state but this time instead of simply saying use State and then getting the value and the setter in this case you're getting the current state of

04:04:03 the form as state you're getting this patch which is the action that we trigger to dispatch or trigger the form meaning update and then we get is pending which is a Boolean indicating whether the action is currently pending to this hook you also provide the action which is a function that is triggered when the form submit you can think of this as handle submit you get the initial state of the form and then an optional Perma link containing the unique page URL that the form modifies so with that in mind let's actually add

04:04:38 the use action State hook to the code we can do that right here at the top I'll remove this is pend and I'll say const we can get the state the form action and the is pending state by saying is equal to use action state which you call as a function of course we have to import this use action State as we learned directly from react so we can get it right here to it we need to provide the actual action that'll happen once we submit the form so let's create it const handle form submit is an arrow function which we can call right here

04:05:20 handle form submit that's the action and we can also pass the initial state of the form which can be set to an error which is set to an empty string as well as a status which can be set to initial like this we can also declare this handle form right here above so we can use it here and we have to fix the typo in the error right here we'll soon look into this tapescript warning but before that let's focus on the validation of the form for validation we'll use Zod Zod is a simple typescript first schema

04:05:55 validation with static type inference and to implement it you can create a new file in our lib folder that's going to be right here and let's call it validation dots within it you can say export const form schema is equal to Z doob and then you pass in all of the properties that you want your inputs to have and of course we have to import Z from Zod so which kind of fields do we have well we have a title right here so we can set that title to be a z. string with a Min so Min of three characters and that Max of about let's

04:06:40 do 100 characters let's add a description Z that string. Min let's do something like 20 and 500 so that's going to be a bit longer let's do a category which can be set to a z. string as well with a Min three and Max 20 let's add a link which is going to be a z. string. url. refine where we have a callback function where you get the actual URL that the User submitted and then you can do additional checks on it you can open up a new try and catch block which is going to look something like this and we

04:07:23 have to ensure that the URL provided is an actually valid image URL so we can say constr is equal to await fetch. URL with a method being set to head so we're not fetching the actual contents the image we're just fetching the head to get access to its content type so we can say const content type is equal to rest. headers doget content-type once we get it we can check if content type question mark. starts with image slash because it can be image BNG JPEG and so on if it does we'll return true else will return false and

04:08:12 in the catch will also just return false because something went wrong so we're doing some more complex validation to check whether the URL is correct and we can make this function async because we're using a weight right here and it's saying that this if statement can be simplified sure it can we can just return this because this function starts with by itself returns true or false so check this out the same if statement can be written just like this if it starts with it will return true else it will

04:08:44 return false finally below the link we have the pitch which is going to be a z. string of Min 10 characters and that Max about let's think about it well we don't even have to provide a Max on that one it can be much longer so now we have our form schema which we're exporting and we can use it back in the startup form so let's dive into the handle form submit further by first making it accept a previous state of the form which is going to be of a type any and form data of a type form data then we can open up

04:09:24 a new try and catch blocks if there's an error we can return that error and we can also give it finally finally happens either way so which code you want to run when either it fails or it succeeds so let's focus on the try first we can get access to the form values by saying const form values is equal to an object or we can specify how can our form data look like we'll get the title by saying form data. getet title and we can say as string just to make sure that typescript is Happy next we can do a description and

04:10:01 set it to be equal to form data. getet description as a string we can repeat the same thing for the category and we can repeat the same thing for the link link is form data. getet link as string and finally we'll just set the pitch like this because we don't need to get it from the form as we're managing it as a separate individual State now that we have the form values we want to validate those values by saying await form schema which we just created which we're importing from validation parse

04:10:36 async form values okay so we want to take the form values and we want to compare them with the form schema to see if they match if they do we can proceed by saying const result is equal to a wait and here we can call a new mutation called create idea which right now doesn't exist to which we can pass the pref state the form data and the pitch for now I will comment it out and right below it we'll want to console log the result just to see how well it works since we're using a weight here we have to turn this into a sync

04:11:17 and you can see that now tapescript is not complaining about the initial state but rather to use action State it'll fix once we finish working on the handle form submit but for now we want to test out whether we actually get all of the necessary values from the form when we submit it so let's actually consol log the form values and save it we can give it a shot by filling all of these values we'll have to sometimes use longer values because because we do have some validation put in place I'll enter test

04:11:47 right here and actually I'll enter htps colum test.com to see whether this will succeed and we have some fake pitch so let's click submit it's submitting okay check this out it cleared the form and said please check your input and try again pretty cool we failed on the description and we failed because the URL wasn't a valid image this was a pretty cool validation to be honest what we did for the image you can completely refine your validation and you can do some more complex checking like the one we're doing here by

04:12:25 checking whether this is an image or not so now let's try to fill this properly by entering a few more characters here entering a category and I'll find some image URL online such as by going to the deployed website and picking one from here let me go with this one right here copy image address and I can paste it and I'll enter just a test for the pitch right now and I'll make it a bit larger there we go I'll bold it and give it a horizontal Rule and one horizontal rule at the top okay let's submit our pitch

04:13:04 submitting success your idea has been created successfully oh this was not what we were supposed to take a look at I mean I mistakenly submitted the form on the finished version of the YC directory app not the Local Host 3000 so let's actually test it here but before that let's actually validate our inputs we can do that by going into the catch right here and checking if error is an instance of Z do Zod error like this and we have to import Z coming from Zod there we go now this allow us to check for the errors if it is an

04:13:47 instance of that we then want to get access to specific field Errors By setting that equal to error. flatten so we'll flatten them all in a single array and say field errors then we want to set errors to be equal to field errors as unknown as record that'll have a string and string so this is just for tab script to be happy and then we can return a previous state and modify the error to say validation failed with a status equal to error all uppercased like this so now we're properly throwing errors if it's

04:14:40 some other kind of error so not an instance off error right here then we can just return the previous state the error saying something like an unexpected error has occurred and then we can set the status to be set to error great so now we're handling the catch and I don't even think we'll need the finally so I'll remove it for now so now we can check whether the validation actually works I'll enter some things right here category click submit okay we have to add a URL and if we click submit nothing really happens it just clears

04:15:22 the entire form oh and I think I know why that is this function is never actually getting called because if you check the action of the form we're not actually passing the form action which is the handle form submit so what we need to do is pass the form action right here as the action that way when we submit the form this handle submit function will actually be ran so let's one more time try to submit it with form action like this and let's click submit it's submitting and there we go now we get invalid URL input perfect

04:16:00 that means that the validation is actually working in case something goes wrong we can also show a shat CN toast that'll be a little alert component saying that something went wrong to make that happen let's let's go to our layout and this will be the layout not within the root but the general layout this one right here and there right below the children we can add the toaster component coming from components UI toaster and now back in the startup form we can render a specific toast by first of all getting access to it at the

04:16:35 top const toast is equal to use toast which we have to import from hooks use toast and now we can trigger it at different point of our application such as when there is an error when we set the errors we also want to show a toast that will have a title equal to error it'll also have a description something like please check your inputs and try again and we'll have a variant of destructive which means that it'll be a red error we can also copy it and duplicate it right here below for or an unexpected error so that it can execute

04:17:16 before the return here we can just say an unexpected error has occurred great finally we'll also do another toast if everything goes right so right here below the Consol log of success we can say if result. status is triple equal to success all uppercased then we can show a toast that's going to say success with a description equal to your startup pitch has been created successfully and below that once that happens we actually want to reroute to that startup Details page so let's import the use router right here at the

04:18:02 top by saying const router is equal to use router coming from next navigation and then right here below we can say router. push pointing to forward slash startup SL result. ID because that's going to be the ID of our new startup that's going to be within if result is Success so let's put it here and finally we'll just return result to know that everything went right but for now we want to comment this out because we don't yet have a function a mutation that will actually create the idea for now we just want to see whether we get

04:18:41 up to this point of the application where we actually get access to the form values the user is trying to submit and I have to comment this part out so now that we have the toaster and everything let's give it a shot I'll try to make it fail One More Time by providing fake info and clicking submit yeah we can see the description fails the image URL fails and the string must contain at least 10 characters fails as well so let's now fix this I'll take in some some actual titles and descriptions like

04:19:16 skill Forge a platform that uses AI to create custom learning paths for individuals based on their goals I'll also take a real image URL category can be something like edte educational technology and for pitch details I will also take some prettier looking markdown we can see how that looks like right here let's make sure to properly bolded there we go this is looking better so let's click submit now and as you can see we got a new conso log in the startup form that gave us all the information that we just filled in which

04:19:56 means that it's properly getting through we have a category description link pitch and a title everything needed to actually submit a startup which means we are ready to take this form data and pass it into a new server action called create idea which will submit that startup and we'll do that in the next lesson but for now let's sum up what we've learned in this one you'll learn how to use the newest use action State hook that allows you to update the state of the form based on the result of a

04:20:25 form action it Returns the state the form action and the is pending State and to it you have to pass the submit Handler the initial State and another optional parameter but as with anything in life it has its good and bad sides L Rob one of the public developer ERS ad verell who's teaching about react nijs and the web shared his views on the Ed action State The Good The Bad and The Unknown react 19 is making data mutations easier you can call an action on the client or server and have built in hooks for pending States handling

04:21:01 errors optimistic updates and more you're able to write less user code a lot of which was previously boilerplate and hopefully can create better uis with these abstractions the good being that one of the hooks you can call is called use action State and if you're using the nextjs app router you might have seen the use form state but now that is the updated version of that as we've learned overall the hook works well as intended and definitely contains less code than you would typically need for a form but

04:21:31 there are also some downsides like it feels like it's fighting typescript often when you move from calling a form directly to using use action State this changes the function signature export Asing function save action to export async function save action with the previous state and the new form data not a big deal right but something that is a bit of a bigger deal especially for me is that I haven't yet figured out the most common use cases regarding the previous state but one of the bigger downsides for me is that server actions

04:22:03 will automatically reset the form on submission which is nice sometimes but not always what you want which is what you were able to see in our case as soon as we submit it it actually cleared all the fields exactly what he says next if there's an error in your action and you return some object you ideally don't want to blow away the client side values in your form instead you want to retain those values and maybe show an error message under the input since the default behavior is to reset the form

04:22:32 you have to save all of the form input values into use action State and then derive those values from that state in the component so with that in mind I'm sure that the use action state will evolve and grow but for the time being it is definitely a welcomed Improvement in how we're dealing with forms in the newest versions of react and nextjs to submit our startup we'll have to do it through a mutation through a server action server actions can be defined by using react use server directive you can place them at the top

04:23:06 of an async function or Mark the entire file as use server something like this where you can have multiple server actions in a single file understanding server actions is still incredibly relevant in all new versions of nextjs and if you don't really know what a server action is I go into much more depth about them in this video which I'll link below teaching you how to develop serers side applications with server actions and even teaching you how to build a simple application using them so pause this video and watch this first

04:23:38 if you don't really know what the heck are server actions but if you do know a bit about them and you want to proceed right away that's totally okay we can do that let's go over to lib and create a new file called actions. TS within there as you know you can immediately put a use server directive at the top because all of these functions will be rendered on the server so let's create our first server action by exporting it and declaring it as create idea or you can call it create pitch I think that makes a bit more

04:24:16 sense and let's set it equal to an async function that looks something like this it'll accept a state as any and form as form data as well as a pitch itself of a type string next we also have to get info about the user who is submitting it so let's get access to the active session by saying session is equal to await o and we need to import o coming from next off or rather add for SL off if there is no session we can just return an object with an error saying not signed in and a status of error but

04:25:07 you can just return objects like this what you have to do is wrap them in json. pars but first they have to be wrapped in json. stringify like this so just so we don't repeat this Json parse Json stringify every time let's actually create a new utility function right below the format date we can say export function parse server action response which will be of a type T it'll take in a response of a type t as well and it'll return json.parse json. stringify and then whatever response we pass into it now this allows

04:25:51 us to very easily call it and wrap any object we want to call directly with this new utility function which we have created perfect now that we have covered the edge case if our user is not authenticated let's try to destructure all the values from the form by saying const title description category and the link is equal to object Dot from entries because it's all within an object and then out of that we can form array Dot from form and we want to filter each property where key is not equal to pitch so we

04:26:35 only want to keep the pitch even though this might seem a bit complicated it's the simplest way that I found it that works we keep the title The description category in the link and then we get the pitch from here finally we also have to form a slug and a slug is basically a unique identifier for that specific startup you could generate it randomly but I found this package called slugify which is very minimal works very well it just basically creates a meaningful slug for each post so let's simply install it

04:27:07 by running mpm install slugify and we can say con is equal to slugify to which we can pass title as string and we can provide additional options as lower is true and strict is true as well finally now that we have all the info such as the title description category link pitch and then the slug as well we can open up a try and catch block let's first handle the catch where we're going to consol log the error so we know that something went wrong and we'll also return a parse server action response

04:27:47 where the error will be equal to json.stringify error and the status will be set to error and now for the try we have everything needed to form a startup so let's do that con startup is equal to an object that has a title a description a category an image which is going to be a link a slug of a type Slug and current value of slug make sure you put the underscore here for the type we also have the author so we have to connect the startup to the author which is going to be underscore type is equal

04:28:30 to reference and the actual underscore ref will point to the session question mark. ID which is the ID of our author and finally the pitch which is the mark. content let's see if slugify has been imported properly we have to say import slugify from slugify there we go and now we can write to sanity client to create it by saying const result is equal to await write client. create a document with an underscore type equal to Startup and we will simply spread out all of the startup values directly within this document which we're

04:29:17 creating within the object once we get the result we can simply return a parse server action response where we spread out the result error will be set to an empty string and Status will be set to success there we go so basically what we're doing is this we are getting the necessary params such as the form data and the pitch which is also kind of like form data but it's in a bit of a different format in markdown or a string in this case then we extract this session because we need to know who is

04:29:54 the author of the startup we check whether a session exists we extract all the values from the form we create a slug we take all of those pieces of data including the form data the generated slug the author and the pitch itself and we write to sanity to actually create it in the database and then we return it back and this is called create pitch so now we can go back to the startup form and we can uncomment our lines right here but instead of create idea I'll rename it to create pitch and there we

04:30:32 go I don't think I even need to consol log the result or the form values because we will see the toast hopefully and we'll be redirected to that startup detail if the creation is successful so let's go ahead and test it together one more time I will use the values from a real startup skill Forge which is an AI platform that uses AI to create learning paths I'll grab in the image address and the category can be set to something like edtech and finally I will add the pitch details right here and maybe make this

04:31:08 skill Forge a bit larger let's see there we go this is looking good so let's submit our pitch it's submitting and we got redirected to a 404 which is a good thing because for a second there we saw your startup was created successfully if you head over to localhost 3000 Studio you should be able to see skill Forge or in your case whatever title you used indicating that the new startup has been successfully created from the form within our application and it should already be visible on the homepage but I'm

04:31:45 wondering why didn't redirect us to The Details page of that startup well it's because the URL says undefined that means that this result ID was also undefined so why is that oh the result has an underscore ID and not an ID so this little fix should actually make it work great but for now let's manually navigate to homepage and hopefully the new startup will appear right here there we go keep in mind that it can take up to 60 seconds and you might need to clear the cache because it's pulling it

04:32:19 from a CDN but once it actually updates you can see it here you can go to its Details page and would you look at that we have successfully created a real startup and if you reload you should be able to see that the number of views is one and it'll continue increasing great I'll quickly head back over to sanity Studio to delete the fake startups we had created with a fake user so it was just Adrien not a real user so let's go ahead and delete these three documents because we now have the possibility to create new ones coming

04:32:55 directly from the platform there we go and I'll delete this one as well finally we can go under authors and you can delete this fake author that we have initially created because now we have real one authenticated with next author using GitHub ooth and with that we only have one startup we have the ability to search for startups skill Forge there we go or we can clear it and we can now create startups the majority of the functionality has already been implemented but of course we'll continue until this actually feels like a real

04:33:33 SAS application that allows entrepreneurs to pitch their startups so if you want to take a bit of a pause now would be a perfect time to do so you deserved it take a pause go for a walk or go to sleep if watching this late at night and come back soon now that some of our apps major functionalities have been successfully implemented it's time to make sure that hundreds of thousands of users that will use them don't break them and to make sure that doesn't happen we'll use Sentry the best application monitoring

04:34:07 software considered not bad by more than 4 million Developers click the link in the description to follow along and see exactly what I'm seeing then create your account once you do you'll be redirected either to the dashboard or to the onboarding if you're already using sanity to track your production level applications like I am then you'll be in your dashboard but in this case we want to start from scratch so in your url after your Sentry account name simply type on boarding which will open up this

04:34:38 nice welcome to Sentry your code is probably broken maybe not not let's find out on boarding process so let's go ahead and click install Sentry choose nextjs as your framework of choice and let's configure it together you'll have to copy this command and then head over to package Json and in the same way that we have overrides for react and react Dom versions I'll add another override for the version of nextjs so simply say next dollar sign next this will ensure that Sentry uses the same version of

04:35:14 nextjs that we're using in our project now you can open up the terminal and paste the command we copy from sanity right here feel free to change the name of the project in our case I'll use YC directory and press enter then press y or enter say that we do have a Sentry account and you can choose this project right here and click continue There we go you can select the existing project and Sentry is being installed with mpm it'll then ask you whether you want to Route Sentry requests in the browser through an xgs

04:35:51 server in this case I'll say no as this can increase the server bill it's not like we're going to get charged or anything as Sentry has a very generous completely free tier but it's nice how they said we'll leave this option commented for later just in case I swear Sentry has one of the best developer experiences out there do you want to enable react and an notations in this case we can say sure yeah do it do you want to enable tracing yep why not Sentry session replay yep let's enable it do you want to create an example page

04:36:24 yes let's do it are you using cicd tool yeah we'll be using versell later on so let's say yes and it's giving us a Sentry o token which you can copy now and press yes continue and there we go successfully installed the Sentry nextjs SDK you can validate your setup by restarting your Dev environment and then visiting Sentry example page so let's do just that I'll head over to Local Host 3000 SL centy Das example- page and there we go this is a page that was added to our application by Sentry and for the first

04:37:00 time ever I'm going to purposefully throw an error just to make sure that Sentry is actually watching over us and alerting us about those errors there we go error has been thrown and now at the bottom you can see error received so let's check out the error in our project dashboard and there we go it might take up to a minute for this error to appear but there we go sentury example error four events priority high and you can now get into it to see more details first of all you're getting additional

04:37:30 information on where this error happened unhandled Sentry example API route error and here's what's cool about it right now sure we could debug this error they directly within our browser or dive into code and fix it super simple right but the problem occurs when a user breaks your application and typically no matter how much you test users will always end up breaking it so when they do break it imagine how painful it is to ask them to open up the console and send out a screenshot of what they're seeing then

04:38:06 they're not going to copy and paste it they're going to take a photo of it with their phone and debugging it will be super hard so for that reason Sentry simplifies tracking and resolution of those errors by giving you event highlights of how the error has happened it happened in the development environment on this specific URL by doing this specific transaction on this specific browser we can also see the line of code pointing to that error and even the version of the operating system and the device that a user was using it

04:38:40 also gives some additional information such as as the browser version device architecture I mean this is pretty crazy stuff that's going to allow you to debug your applications much more simply and think about it 100 users are going to have 100 different devices and 100 different browsers so being able to track first of all and then debug just makes your applications so much more scalable you can also view the full Trace right here and see exactly how the error has happened and for some types of

04:39:10 issues like this Cent example frontend error you can actually check out the replay there it is so if I play it first of all you can see that all the characters are just asterisks because Sentry wants to protect the privacy of the user breaking your site but you can still see what they were doing at the moment when they actually broke it you can see exactly which pieces of UI they were clicking with which headers and on which URL that allows you to go back to the code and fix it once you deploy a

04:39:42 hot fix just go ahead and click resolve but of course as the application grows and gets more users as we can see right here you'll get so many monitoring and tracking features provided to you by Sentry simply put you can see which Pages your users are breaking the most this Trace view is super useful of course I don't even have to mention how useful the replays are for example let's check out the user that had most dead clicks and let's set the time span to last 30 days let's check out this user

04:40:11 for example this one is a bit crazy Windows 10 plus on the Opera browser they were actually exploring the healthcare application that I created not that long ago you can see exactly what they were doing even though everything is completely blurred so if the error has occurred we would have known we can see exactly which elements they were clicking and and we can also see what was happening in the console and the network tab of their browser this makes the debugging process super simple along replays there's also

04:40:41 performance that allows you to track how quickly certain pages are loading for your users so that way you can figure out if some pages are loading slowly for whatever reason you can also very quickly add a user feedback model so that good users that don't break your application can report bugs on their own as a matter of fact let's go ahead and add it together right now I'll simply click setup now and we just have to add this part to the Sentry client config so let's copy this entire thing head over

04:41:10 to Sentry client config and under Integrations along replay we can also add this one here Sentry do feedback integration if you do that and go back to your application check this out a new report a buug floating button appeared at the bottom right you can click it enter your name and email add a screenshot of the bug and then say the search isn't working for me just an example and we can send the bug report in an instant then if you go back to the user feedback part of your dashboard and reload you can immediately see a new

04:41:49 ticket raised right here the search isn't working for me but it's not like you're only getting this text or a screenshot you're getting much more like the URL they were on the replay that was happening before they actually sent the message and all of the things that we have explored previously such as browser and more information and you can also immediately track this issue in jira GitHub or any other platform there's also some generic stats so you can see how good your app is behaving but in general that is it I don't want to bore

04:42:19 you with a lot of other details what I really wanted to say is that if you only add Sentry to your app for which the setup literally took like 10 presses of the enter key and 3 minutes already you're making your app so much more secure less error prone and more bug free and if this is looking too good to be true I mean let's check out their pricing for s devs working on small projects it is completely free you're one user and you get all the error monitoring and tracing that we talked about if you're going to be the only Dev

04:42:51 using it that's more than enough so great job implementing Sentry and making our app that much more bug-free for our users to enjoy I was planning to end this chapter here but then I stopped recording and went to check out my email and I just had to show this to you as well while we were testing and our users were breaking the app Sentry actually sent out an email alerting us about those issues in real time so as soon as the error happened we immediately got all the important information about the

04:43:23 error including the tags we talked about earlier letting us know exactly what broke so this is the type of thing that if you're running a serious SAS application and there's a breaking bug you want to be able to fix it as soon as possible so it's good to know that this is offered too now onto the next chapter next let's create a user profile route we can do that by opening the file explorer going to root and creating a new folder called user within it create another folder called ID within the square brackets this is a dynamic route

04:44:02 as you already know and then create a new file called page. DSX run RFC inside of there and as soon as you save it you'll be able to click on your profile to actually navigate you to a profile page there we go so before we start with the UI let's actually fetch the user details right here at the top I will destructure the params of this page and I'll specify the type perams is going to be of a type perams which is a promise that contains an ID of a type string something like this then we we can extract the ID from

04:44:42 it by saying ID is equal to await per rams. ID and since we're using a weight we have to add a sync right here next we can get the session by saying con session is equal to a wait o and we also have to import o from add SLO next we can fetch the user by saying const user is await client. not fetch and this client of course is referring to a sanity client and we have author by GitHub ID query to which we're going to pass the ID finally we can check if a user doesn't exist we can return a not found which is going to navigate us to

04:45:31 a404 but as you can see here we get a404 this query isn't really going to cut it it's getting the author by GitHub ID which is called ID but in here we have to get a user by its own ID by the author ID so let's duplicate this entire query and let's just rename it a bit to getting the author by ID query and we're going to refer to the underscore ID property so the only thing we have to change is this underscore ID once you do that and replace this query and remove the one that we just imported you'll see that now we'll still be on

04:46:13 the same page without getting redirected to a 404 that means that we actually have the user and we can start creating the UI for the user Details page let's start by turning everything into a react fragment within which we will have a section this section will have a class name equal to profile uncore container and within this section we'll have another div with a class CL name equal to profile card and within it we'll have another div with a class name equal to profile undor title within which we will

04:46:54 have an H3 element that'll have a class name equal to text- 24- Black uppercase and text- center and ending it with line clamp one so it doesn't go into multiple rows within there we can render the user.name if I save this we get this funky UI that says Adrian JS Mastery for you it's going to be something different and if you're wondering how did we accomplish the styles to achieve this funky UI you can just search for profile title or profile card and see exactly which styles are getting applied now let's go

04:47:33 below the H3 and below the div and create a next GS image this image will have a source equal to user. image with an ALT tag of user.name a width of 220 a height of 220 and a class name of profile uncore image and there we go this one got pulled directly from my GitHub this is kind of a face reveal I'm standing right here next to my GitHub star at the GitHub Universe conference going below this image let's render a P tag with a class name equal to text- 30 extra bold margin top of seven and text- Center we can render at

04:48:20 and then user question mark. username perfect right below this P tag let's create another P tag with a class name of margin top of one text- Center and text -4- normal within which we can render user question mark. bio in this case you should be able to see nextjs and iast and educator for you it's going to be something else let's go below this div and let's create another div with a class name equal to flex D1 Flex flex-all gap of five and then extra large devices minus margin top of five within which we can render a P tag with

04:49:07 a class name equal to text D30 - bold and there if the session question mark. ID is equal to the ID of the currently logged in user then we can say your else we can say all and then we can render the word startups So currently I am on my profile and you'll be able to see your startups but if we were on somebody else's profile you would be able to see other startups or rather all startups next we can render a UL which is an unordered list with a class name of cardor grid DSM and here we'll render a list of this

04:49:53 user's startups so user startups and we'll do that very soon but before we do I want to explain that this is the perfect use case for PPR all the user info you're seeing here such as the name username bu and profile photo can be statically rendered for a longer time but the user created startups have to be dynamic so here we'll want to enable PPR I'm going to go right at the top and say export const experimental undor PPR is set to true and I think you can slowly start seeing the exact use cases where PPR might come

04:50:36 in handy whenever you have some static data like we have explored the the product details before but recommended products because they have to be recommended by some kind of dynamic algorithm or maybe Dynamic shipping those things have to be dynamic same thing here the new user startups have to be dynamic so now let's create a new component in the components folder and I'll call it user startups do DSX I'll run rafc and I'll import it right here in this unordered list I'll render user startups as a self-closing component and you can

04:51:21 see it appear right here now that we have this component we also have to create a query that would allow us to fetch all the startups created specifically by that user so let's copy one of the startup queries it can be this one here startup squarey the first one we have ever created copy it paste it right here below rename it to startups by author query here we're searching for a startup but now we're going to remove this part all the way up to here yeah we're going to remove this entire part we're just going to keep the order

04:52:04 okay so we're going to say and author doore ref is equal to do sign ID so we're comparing it to the author we're searching for and we will still order it created at descending and then we want to return all of the information that we previously returned great so now we can copy the name of that and go back and we can import it right here by saying const startups is equal to await client referring to sanity client. fetch startups by query and then we pass the ID of the author we're searching for and how do we

04:52:47 get the ID into this component well we can pass it as a prop ID is equal to ID so we can very quickly get it right here through props by saying ID and specifying that this ID is of a type string since we're using a weight we have to turn this into a synchronous function and we get access to startups right here finally we can return an empty react fragment where we're checking if startups that length is greater than zero then we can return posts or startups do map where we get each individual startup of a type startup

04:53:33 card type which we'll have to import and for each one we automatically return just by using parenthesis is a startup card a startup card has to get a key because we're mapping over it of post do dollar Sun ID and the post itself which will be equal to Startup now let's properly import the startup card type which can come right here from startup card let's see how did we call it in there startup type card there we go I fixed it and here I'm going to also refer to this as a startup doore ID and of course we have to have the

04:54:13 second part of the turnery which is going to just render a P tag with a class name of no result and it'll say no posts yet let's make sure that we properly indented right here there we go I got it let's see why is it complaining I'll try to reload the server to see if that fixes it oh but the error is still there and you know what this might be we missed one thing we're doing a fetch right here and we're using it within a PPR component but we might need to wrap this newly created component into react

04:54:52 suspense because this will take some time to load so first we need to show a fullback for it so let's create a suspense component with a fullback equal to a P tag off loading dot dot dot and now we can put user startups within it and there we go that fixed it but it brought back the issue so that means the issue is still somewhere here within user startups maybe we messed up the query while copying it we're starting with this square bracket here but we're never actually ending it so let's end it

04:55:28 here and save it and there we go we immediately get back our startup and as you reload you'll see that the top part loads immediately but right here at the bottom there's a quick loading that appears and instead of Simply showing the text that says loading let's actually install a shaten skeleton component a skeleton component is a grade out rectangle that makes it appear like the entire div is loading it looks so much better it makes the user wait a bit longer for it to load so let's run MPX shaten at latest add skeleton looks

04:56:07 like we have already added it before so let's head over to the startup card and right at the bottom of it we can say export con startup card skeleton and we can have an instant return where we return a react fragment where we map over let's say 1 2 3 4 five maybe different cards by saying that map we get the first element and the index of that element which is a number and for each number we return An Li of key is equal to CN which we have to import from utils skeleton and then the index as a matter

04:56:52 of fact our numbers are actually indices so we can just use the first parameter of the map as an index and we can pass it here that's going to be of a type number and then within it we can render a skeleton component coming from components UI skeleton with a a class name equal to Startup Das cardor skeleton now we're exporting it and we can go back to our user Details page and we can use it right here instead of the loading startup card skeleton it's going to look like this so now if you reload you should be able to see

04:57:33 something that resembles a card appear before the card actually appears maybe if I go to inspect element and I go to network and I turn on slow 4G maybe we can see the loading appear now that was still too fast well what if I do command shift R which is going to clear the cache as well it's super fast maybe even too fast to be able to see it but there we go for a second there as I reloaded or a millisecond while the card was loading you were able to see this one right here now I can notice that we

04:58:06 forgot to replace the Avatar right here because this one was created by the the new Avatar so let's actually fix it by going over to Startup card and we'll search for where we show the Avatar image right here instead of this Source we can rather render author question mark. image and now we can see a real image appear right here that's much better and we can render the author name as the AL tag for it perfect this is great so would you look at that this is our second page where we used partial pre-rendering to show user details

04:58:43 statically and then to dynamically render new startups that that user has posted looking great now one thing that I think we forgot to do at the start was to update the navigation bar to be a bit more mobile responsive so if I go to mobile view or rather collapse it like this you'll see that it doesn't really fit all the way like it does in tablets but not on smaller mobile devices so let's quickly go back to the Navar and let's find the button where it says create right here let's give it a class

04:59:18 name on Max SM it'll be completely hidden so you can see it will disappear but now below it we can show a log out icon which will have the exact opposite class it'll be a size of six but on small devices it'll be hidden and it'll have a text red 500 so now we'll have a little logout icon this doesn't go under create this actually goes under log out so let me put it right here below this logout button and for it we have to do the same thing as we have done above turn it into a span so I'll copy this create and I'll just

05:00:02 make it say log out there we go below the create span we can create a different icon this time it'll be a badge plus icon once again with a class name is equal to size of six and then SP devices hidden and finally we can also replace the user Avatar here where we show the user avator name instead of the full name let's rather render the image shat CN has a perfect component for that so let's run MPX shat and latest add Avatar that'll allow us to remove this span and instead of it render avatar coming from components UI Avatar with a

05:00:49 class name equal to size is set to 10 within it we'll have an avatar image also coming from components UI Avatar it'll be self-closing and it'll have a source equal to session question mark. user question mark. image let's fix this class name spelling and and let's give this Avatar an ALT tag of session question mark. user mark. name or an empty string in case we don't have it same thing here or an empty string and below it we can also render something known as an avatar fullback coming from components UI

05:01:31 Avatar which will allow us to render some kind of a foldback if the image is not there we can say something like AV for Avatar let's fix this this class name right here and there we go we have a great looking Avatar Photo and now if you expand it a bit you can see now it's a bit different yes the Avatar is showing but now it says create log out and then smaller devices we can see the icons great work coming this far into the video in the next lesson I'll show you how to add another great feature do you know about the website

05:02:07 called Awards the one that recognizes and promot great websites well I'll teach you how to implement a feature to our YC directory app similar to what awards has if you head over to explore you'll notice that there are many different categories like honorable mentions nominees site of the DAT site of the Year side of the month and more well these are in simple words playlists or some kind of categories of different startups or different designs whatever it may be so let's Implement that into our app as well different kind

05:02:40 categories of startups we can do that by first creating a new schema in sanity schema types and create a new file and call it playlist. TS to create it we can copy what we have in startup there we go and then paste it in the playlist and make the necessary adjustments such as let's name it playlist give it a name of playlist a title of playlists it'll be of a type document and then we can Define different fields I'll delete a few of these as we only need three in this case the first one will be a title

05:03:20 string the title of the playlist the second one will be a slug and the third one will be a select which is a type of array like this and it is going to be an array of different references so we can say type is reference and a reference to what you may ask well a reference to a type of startup that's going to look something like this so what do I mean by this well each playlist will refer to multiple startups and it'll have its own title like startups of the day or startups of the year so as soon as you do that let's

05:04:03 head over to index.ts and let's add playlists or playlist right here as the third type importing playlist from schema types playlist if you save it you can rerun your application and then head over to sanity Studio once you're there you can click this create button and create a new playlist you can give it any name you like such as best pitches or startup of the day or something like editor picks so startups that YC directory admins have liked the most we can generate cre a slug and now you can select different

05:04:43 startups you want to add to this playlist and see how simple this is you can just refer to different ones like skill Forge in this case and that's it it'll automatically be saved I'll pause the video for a second to create a few more startups just so we have some more startups to choose from and while I'm adding startups you can also add some additional pitches too there we go I went ahead and added a few more startups now typically it'll take 60 second for the cache to reload or you can just hard

05:05:13 reload it and there we go so now I can actually add a few more startups right here to editor picks I'll add JS Mastery Pro and I'll add events sphere and I'll click save at the bottom right there we go our editor picks have been published now we have to write a query that fetches the playlists by the slug so let's head over to queries and let's write one last query considering that we already wrote quite a couple I'll actually provide this one to you in the read me of this video so you can just paste it

05:05:51 here the name will be playlist by slag query and it'll search for documents of theore type playlist where a slug exists and then it's going to return everything including all the necessary info for the startups within that playlist great we want to show these editor picks on the startup Details page but you can really put it anywhere you could also render it right here below the all startups but for the time being I'll render them below the details of a specific startup so right here below so let's copy the name of the

05:06:29 query and let's head over to Startup details so that is going to be this page right here which is under app Root startup ID and the reason why we're doing this here is because I want to show you a special feature so first things first let's say const the structure select as editor posts or editor startups is equal to await client. fetch where we pass in the query and then we can also pass the slug that you're trying to fetch in this case I called it editor pick new for you most likely it's going to be editor pick once

05:07:10 you do that you can go below to where we left are to do right here and you can check if editor posts question mark. length is greater than zero then we want to render a div with a class name equal to Max dw- 4XL and margin X of Auto A P tag that'll have a class name equal to text D30 - semi bold and it'll say editor piix right here we can render a UL an unordered list with a class name of margin top of seven and a cardor grid of small like this within it we want to map over editor posts by saying that map

05:08:01 where we get each individual post which is of a type startup type card and we also get the index of a type number and for each one we want to Simply return a startup card that's going to look something like this with a key equal to index and a post equal to post but make sure to First import the startup card and we can just call index I there we go and immediately you should be able to see however many posts you have chosen as editor picks this is great as now editors can go directly in sanity studio

05:08:37 and choose their favorite startups now allthough this works and it is fine we have a little issue and that is that we have to be aware of two different data fetching patterns parallel and sequential when fetching data inside components you need to be aware of those two patterns so as you can see in sequential one is happening after the other one two one 2 one2 so it's trying to load both of the things first for the root layout then for the second page and then for the third page one by one but in parallel it's actually loading one

05:09:16 thing for all the pages and then it's slowly loading the other which takes much less time as you can see here in sequential requests in a component tree are dependent on each other which can lead to longer loading times but in parallel requests in a route are eagerly initiated and will load data at the same time which reduces the total time it takes to load data what we have done just now is sequential we're first fetching the data about the post and only then we're fetching the editor posts so what does this mean well

05:09:49 this means that we first fetch the post data and only after that is complete then we fetch the editor picks but the time to fetch both will increase as it will be the sum of both of these requests this approach is great if the second request depends on the first one but in this case they're completely independent so we can take advantage of these modern systems that are capable of handling multiple requests concurrently so let me teach you how to implement parallel requests it's going to look something like this you'll say

05:10:23 const and then do array D structuring and say this is equal to await promise.all promise that all allows you to pass two different calls and then for each one you get the result right here D structured so the first call is going to be this one client fetch startup by ID query so let's copy it and let's add it as the first element in the array the second one will be this one client fetch playlist by slug so let's copy it and add it as the second one great and now we can just get the result of both of

05:11:04 these at the start we first get the post and then for the second one we can these structure this select editor posts and now we can remove both of these two independent ones as we have just one that does everything this way by using promise that all the code makes two independent requests concurrently and as a result the total time is roughly equal to the duration of the longest request not the sum of both by doing this your application's performance will increase and low times will be even faster compared to making

05:11:43 sequential requests as you can see it is super fast I cannot even see something is loading so now you know a bit about a difference between parallel and sequential rendering in xjs understanding the basics can make a big difference when you know how to fetch data in parallel or use PPR to handle both Dynamic and static content on the same page you don't just make your website faster and better you also grow from a beginner to a senior developer you'll develop the decision-making skills every company wants knowing which

05:12:18 technology to use when to use it and most importantly why and that's why I've included many theoretical Concepts tips tricks and things I wish I knew when I was first learning nextjs in the ultimate nextjs course you'll dive deep into strategies like caching revalidation backend routes serverless functions Edge run times react server components inner workings handling parallel and sequential requests and using the latest features from react 19 and NEX 15 I've made sure to cover everything along with a build and deploy

05:12:55 of a modern stack Overflow clone covering all of these features so today I'm publishing the nextjs 15 version of the ultimate nextjs course loved by over 4,100 Developers who keep messaging me about how this course help them become the best nextg developer in their team at work or get them freelance opportunities and no it's not just a few new lessons of next 15 it's an entirely new course fully re-recorded packed with even more features such as next off for authentication Deep dive into the new

05:13:31 PPR strategy improved database architecture more secure server actions testing using playwright email notifications search engine optimization tips and tricks and much more with a special dedicated Discord Channel where we answered every single one of the answers from all 4,000 developers see it for yourself so don't delay your nextjs dreams and become the best nextjs developer by taking the ultimate nextjs course we have a super sale going on right now which only happens about once a year so visit jm.pro

05:14:09 SL nextjs and join more than 4,000 developers on this journey I hope I'll see you in the course but for now let's go ahead and finalize this application I noticed that when creating a startup we are issuing a toast a toast notification so let me show you how that looks like if we go to the startup form we are sending this success toast specifically this one but I noticed that sometimes it lacks the background ground so let's try to initiate it by default by simply adding it right here at the top and of course closing it properly if

05:14:48 you reload you can see it at the top it's missing the background so let's go to a toast component which you can find by going to the components folder and then UI and then toast I'm actually glad this happened because I can show you how we can further modify chatsi and component onon let's head over to this line right here let's give it a BG white text- slate d950 on dark mode BG slate 950 and on dark mode text slate 50 so we're just changing the text color and the background color if I reload this

05:15:32 fixes it and it's looking so much better so now we can go back and remove this fake toast and and with that in mind I believe our application is done I can go ahead and test it a bit by checking the search Yep this works do we have a word that is shared amongst all of these well I guess just the author is shared so if I go for Adrian y we can see that it finds all of them if I go for event no nothing but event sphere yeah this is good what if I search for Pro yep that works so search is working

05:16:12 everything is working and this app is utilizing the latest and greatest of what react and next GS have to offer so the last step in every single JavaScript Mastery video is deployment so let's go ahead and deploy it to the internet together to deploy it you can head over to your GitHub and create a new repository call it something like YC directory either make it public or private and click create then let's stop it from running and let's follow all of these steps get init get add dot git commit DM first

05:16:52 commit git Branch dasm main get remote add origin oh in this case I already have one so I'll rename it to origin one and get push U origin main once you do that the code will be live on your repo which means that we can head over to versell and create a new project out of this new repo that we just added so let's go to import don't forget to add environment variables so back in our code we have our env. loal copy all of these variables and then paste them right here and we also have the Sentry o token as well so let's copy

05:17:38 it and add it as well not to forget it so let's click deploy now when deploying big applications such as this one especially after doing so many changes it is highly likely and actually probable and expected that something will go wrong and that it won't be deployed on the first time so we can make additional changes later but that's not a problem if it breaks we'll fix it so let's give it some time and I'll be right back and after 2 minutes and 50 seconds it broke thankfully it is just a couple of typescript warnings which is

05:18:14 not a big deal you can go ahead and fix those typescript issues in your project or it's also totally okay to disable them for production builds so that's exactly what we'll do in this case to get our project deployed the only thing you have to do is say tab script ignore build errors to true and you can do that within next config so let's head over to next config and let's add script ignore build errors is set to True similarly we can do the same thing for eslint by saying ignore during builds is

05:18:51 set to true now you can open up the terminal run git add dot git commit DM update next config and then run git push as soon as you do that and go back to your resell dashboard if you go to your project and go to deployments you should be able to see that the update next config push is building fingers crossed and there we go the deployment succeeded so if you go to project and click visit you can see that our application loads but there is a slight error a client side exception error specifically so if you go to the

05:19:31 console you can see that sanity is being blocked by the Court's policy so let's head over to our project dashboard go to API go to course origin and add a course origin for our newly deployed URL we can do that by copying the URL from the app and let's allow credentials and click save now if you go back and reload it all works you might have thought that we broke something else but no we just had to allow it another thing which you'll have to allow is GitHub oath remember to redirect URI you'll have to take the URL

05:20:10 of the current application head back to the O settings for this app and then update the homepage URL as well as this URL right here htps YC directory. L.A or whatever your url is and then leave the rest the same click update application go back reload and click log in one more time and would you look at that it logged Us in automatically so to finish this great video off let's create one final startup actually the startup title will be the YC directory itself we're so proud of it so let's say that this is a

05:20:54 directory of great startup pitches created by the community category is going to be something like business we can take some kind of an image from May YC combinator so I'll just grab the image address and paste it and we can say something like no pitch needed right here this app speaks for itself and let's submit the pitch oh it looks like the image wasn't valid and it cleared our form that's actually One update that I would like you to make play with the new react hook that we used to submit the form and try to

05:21:39 repopulate the fields if the submission fails but no worries I've took another image and I'll say YC directory hopefully this time it works and I'll click submit there we go your startup pitch has been submitted we can see it right here which means that all of our apps functionalities are working and it still didn't appear on the homepage because these results are cached and it can take up to 60 seconds to appear right here beautiful this was such a wonderful build in which we explored the latest and greatest of what

05:22:17 react NEX GS and Sanity have to offer and if you came to the end of this video and you still didn't take the ultimate next GS course I really think you're going to love it considering that you watched all the way until the end of this amazing crash course as I already told you in this ultimate course we dive much deeper into the intricacies of how nygs truly works under the hood we optimize performance to this and we do a lot of deep Dives to truly understand how things work behind the scenes as

05:22:51 well as build an app that is much more complex than the app you've built in this video so considering that you're watching here after a couple of hours of content and you're still here I really think it's a good fit for you I'll leave the link down in the description with that said thank you so much for watching and I'll see you in the next one have a wonderful day
